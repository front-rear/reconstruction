[2025-01-06 22:25:02,513 INFO train.py line 133 2307045] => Loading config ...
[2025-01-06 22:25:02,513 INFO train.py line 135 2307045] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 22:25:02,816 INFO train.py line 136 2307045] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 4678555
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 5000
eval_epoch = 5000
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 22:25:02,816 INFO train.py line 137 2307045] => Building model ...
[2025-01-06 22:25:03,506 INFO train.py line 425 2307045] Num params: 1634304
[2025-01-06 22:25:03,587 INFO train.py line 139 2307045] => Building writer ...
[2025-01-06 22:25:03,599 INFO train.py line 435 2307045] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 22:25:03,600 INFO train.py line 141 2307045] => Building train dataset & dataloader ...
[2025-01-06 22:25:46,428 INFO dataset_render_16views.py line 145 2307045] Processing frame_0
[2025-01-06 22:25:49,230 INFO dataset_render_16views.py line 145 2307045] Processing frame_1
[2025-01-06 22:25:51,768 INFO dataset_render_16views.py line 145 2307045] Processing frame_2
[2025-01-06 22:25:54,093 INFO dataset_render_16views.py line 145 2307045] Processing frame_3
[2025-01-06 22:25:56,445 INFO dataset_render_16views.py line 145 2307045] Processing frame_4
[2025-01-06 22:25:58,843 INFO dataset_render_16views.py line 145 2307045] Processing frame_5
[2025-01-06 22:26:01,149 INFO dataset_render_16views.py line 145 2307045] Processing frame_6
[2025-01-06 22:26:03,344 INFO dataset_render_16views.py line 145 2307045] Processing frame_7
[2025-01-06 22:26:05,676 INFO dataset_render_16views.py line 145 2307045] Processing frame_8
[2025-01-06 22:26:08,225 INFO dataset_render_16views.py line 145 2307045] Processing frame_9
[2025-01-06 22:26:10,557 INFO dataset_render_16views.py line 145 2307045] Processing frame_10
[2025-01-06 22:26:12,796 INFO dataset_render_16views.py line 145 2307045] Processing frame_11
[2025-01-06 22:26:15,049 INFO dataset_render_16views.py line 145 2307045] Processing frame_12
[2025-01-06 22:26:17,503 INFO dataset_render_16views.py line 145 2307045] Processing frame_13
[2025-01-06 22:26:19,867 INFO dataset_render_16views.py line 145 2307045] Processing frame_14
[2025-01-06 22:26:22,164 INFO dataset_render_16views.py line 145 2307045] Processing frame_15
[2025-01-06 22:26:24,458 INFO dataset_render_16views.py line 69 2307045] Totally 16 x 1 samples in train set.
[2025-01-06 22:26:24,458 INFO train.py line 145 2307045] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 22:26:24,460 INFO optimizer.py line 64 2307045] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 22:26:24,460 INFO train.py line 149 2307045] => Building hooks ...
[2025-01-06 22:26:24,462 INFO train.py line 166 2307045] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 22:26:24,462 INFO train.py line 171 2307045] => Loading checkpoint & weight ...
[2025-01-06 22:26:24,874 INFO train.py line 192 2307045] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 22:26:25,435 INFO train.py line 211 2307045] iter: 0, total_loss: 0.46004390716552734, loss_1: 0.406982421875, loss_2: 0.405029296875, loss_3: 0.294189453125
[2025-01-06 22:26:27,347 INFO train.py line 211 2307045] iter: 10, total_loss: 0.4225189685821533, loss_1: 0.40185546875, loss_2: 0.403076171875, loss_3: 0.286865234375
[2025-01-06 22:26:29,242 INFO train.py line 211 2307045] iter: 20, total_loss: 0.3633347451686859, loss_1: 0.41748046875, loss_2: 0.415771484375, loss_3: 0.170166015625
[2025-01-06 22:26:31,136 INFO train.py line 211 2307045] iter: 30, total_loss: 0.3594461679458618, loss_1: 0.416748046875, loss_2: 0.4169921875, loss_3: 0.16015625
[2025-01-06 22:26:33,033 INFO train.py line 211 2307045] iter: 40, total_loss: 0.2906796932220459, loss_1: 0.397216796875, loss_2: 0.395263671875, loss_3: 0.104736328125
[2025-01-06 22:26:34,919 INFO train.py line 211 2307045] iter: 50, total_loss: 0.2509964108467102, loss_1: 0.40625, loss_2: 0.342529296875, loss_3: 0.06915283203125
[2025-01-06 22:26:36,855 INFO train.py line 211 2307045] iter: 60, total_loss: 0.2951816916465759, loss_1: 0.376708984375, loss_2: 0.34228515625, loss_3: 0.0775146484375
[2025-01-06 22:26:38,761 INFO train.py line 211 2307045] iter: 70, total_loss: 0.2961438298225403, loss_1: 0.423583984375, loss_2: 0.356689453125, loss_3: 0.05108642578125
[2025-01-06 22:26:40,665 INFO train.py line 211 2307045] iter: 80, total_loss: 0.21387028694152832, loss_1: 0.3427734375, loss_2: 0.315185546875, loss_3: 0.059295654296875
[2025-01-06 22:26:42,556 INFO train.py line 211 2307045] iter: 90, total_loss: 0.25846919417381287, loss_1: 0.3515625, loss_2: 0.281494140625, loss_3: 0.04827880859375
[2025-01-06 22:26:44,463 INFO train.py line 211 2307045] iter: 100, total_loss: 0.2654586136341095, loss_1: 0.364013671875, loss_2: 0.361328125, loss_3: 0.030517578125
[2025-01-06 22:26:46,373 INFO train.py line 211 2307045] iter: 110, total_loss: 0.24771517515182495, loss_1: 0.3134765625, loss_2: 0.28759765625, loss_3: 0.0419921875
[2025-01-06 22:26:48,314 INFO train.py line 211 2307045] iter: 120, total_loss: 0.16968800127506256, loss_1: 0.306396484375, loss_2: 0.28662109375, loss_3: 0.0261993408203125
[2025-01-06 22:26:50,190 INFO train.py line 211 2307045] iter: 130, total_loss: 0.21375547349452972, loss_1: 0.310302734375, loss_2: 0.22998046875, loss_3: 0.016998291015625
[2025-01-06 22:26:52,102 INFO train.py line 211 2307045] iter: 140, total_loss: 0.20817618072032928, loss_1: 0.297119140625, loss_2: 0.2919921875, loss_3: 0.021270751953125
[2025-01-06 22:26:53,974 INFO train.py line 211 2307045] iter: 150, total_loss: 0.20689627528190613, loss_1: 0.3193359375, loss_2: 0.2237548828125, loss_3: 0.01529693603515625
[2025-01-06 22:26:55,876 INFO train.py line 211 2307045] iter: 160, total_loss: 0.1955941766500473, loss_1: 0.273193359375, loss_2: 0.25732421875, loss_3: 0.0204620361328125
[2025-01-06 22:26:57,793 INFO train.py line 211 2307045] iter: 170, total_loss: 0.1279691904783249, loss_1: 0.1953125, loss_2: 0.1854248046875, loss_3: 0.034576416015625
[2025-01-06 22:26:59,679 INFO train.py line 211 2307045] iter: 180, total_loss: 0.14790980517864227, loss_1: 0.268798828125, loss_2: 0.2178955078125, loss_3: 0.0144805908203125
[2025-01-06 22:27:01,560 INFO train.py line 211 2307045] iter: 190, total_loss: 0.11116977781057358, loss_1: 0.17138671875, loss_2: 0.1492919921875, loss_3: 0.03973388671875
[2025-01-06 22:27:03,453 INFO train.py line 211 2307045] iter: 200, total_loss: 0.16163091361522675, loss_1: 0.2353515625, loss_2: 0.224365234375, loss_3: 0.01491546630859375
[2025-01-06 22:27:05,384 INFO train.py line 211 2307045] iter: 210, total_loss: 0.19350020587444305, loss_1: 0.31298828125, loss_2: 0.24609375, loss_3: 0.006542205810546875
[2025-01-06 22:27:07,286 INFO train.py line 211 2307045] iter: 220, total_loss: 0.13429415225982666, loss_1: 0.2017822265625, loss_2: 0.1680908203125, loss_3: 0.02142333984375
[2025-01-06 22:27:09,147 INFO train.py line 211 2307045] iter: 230, total_loss: 0.093695729970932, loss_1: 0.146728515625, loss_2: 0.115478515625, loss_3: 0.0301361083984375
[2025-01-06 22:27:11,063 INFO train.py line 211 2307045] iter: 240, total_loss: 0.18293426930904388, loss_1: 0.27880859375, loss_2: 0.23583984375, loss_3: 0.00872039794921875
[2025-01-06 22:27:13,004 INFO train.py line 211 2307045] iter: 250, total_loss: 0.13304942846298218, loss_1: 0.2216796875, loss_2: 0.1387939453125, loss_3: 0.0100860595703125
[2025-01-06 22:27:14,891 INFO train.py line 211 2307045] iter: 260, total_loss: 0.10446181148290634, loss_1: 0.1343994140625, loss_2: 0.1339111328125, loss_3: 0.027587890625
[2025-01-06 22:27:16,765 INFO train.py line 211 2307045] iter: 270, total_loss: 0.12282375991344452, loss_1: 0.1396484375, loss_2: 0.1298828125, loss_3: 0.0297393798828125
[2025-01-06 22:27:18,640 INFO train.py line 211 2307045] iter: 280, total_loss: 0.09190475940704346, loss_1: 0.11456298828125, loss_2: 0.1094970703125, loss_3: 0.0318603515625
[2025-01-06 22:27:20,569 INFO train.py line 211 2307045] iter: 290, total_loss: 0.07487577199935913, loss_1: 0.09124755859375, loss_2: 0.07794189453125, loss_3: 0.03826904296875
[2025-01-06 22:27:22,505 INFO train.py line 211 2307045] iter: 300, total_loss: 0.11363169550895691, loss_1: 0.1949462890625, loss_2: 0.1201171875, loss_3: 0.01971435546875
[2025-01-06 22:27:24,397 INFO train.py line 211 2307045] iter: 310, total_loss: 0.09195573627948761, loss_1: 0.11859130859375, loss_2: 0.10638427734375, loss_3: 0.044403076171875
[2025-01-06 22:27:26,278 INFO train.py line 211 2307045] iter: 320, total_loss: 0.06859826296567917, loss_1: 0.09210205078125, loss_2: 0.0792236328125, loss_3: 0.0286865234375
[2025-01-06 22:27:28,162 INFO train.py line 211 2307045] iter: 330, total_loss: 0.09422563016414642, loss_1: 0.179931640625, loss_2: 0.11053466796875, loss_3: 0.018402099609375
[2025-01-06 22:27:30,073 INFO train.py line 211 2307045] iter: 340, total_loss: 0.07706353068351746, loss_1: 0.06585693359375, loss_2: 0.06024169921875, loss_3: 0.05938720703125
[2025-01-06 22:27:31,959 INFO train.py line 211 2307045] iter: 350, total_loss: 0.0661139041185379, loss_1: 0.1015625, loss_2: 0.07379150390625, loss_3: 0.023284912109375
[2025-01-06 22:27:33,831 INFO train.py line 211 2307045] iter: 360, total_loss: 0.06583639234304428, loss_1: 0.07135009765625, loss_2: 0.0599365234375, loss_3: 0.0428466796875
[2025-01-06 22:27:35,715 INFO train.py line 211 2307045] iter: 370, total_loss: 0.0689876452088356, loss_1: 0.090576171875, loss_2: 0.088623046875, loss_3: 0.027191162109375
[2025-01-06 22:27:37,590 INFO train.py line 211 2307045] iter: 380, total_loss: 0.07071960717439651, loss_1: 0.10577392578125, loss_2: 0.09283447265625, loss_3: 0.019439697265625
[2025-01-06 22:27:39,481 INFO train.py line 211 2307045] iter: 390, total_loss: 0.05408664792776108, loss_1: 0.09014892578125, loss_2: 0.0623779296875, loss_3: 0.0228729248046875
[2025-01-06 22:27:41,456 INFO train.py line 211 2307045] iter: 400, total_loss: 0.07936705648899078, loss_1: 0.099365234375, loss_2: 0.093994140625, loss_3: 0.034515380859375
[2025-01-06 22:27:43,369 INFO train.py line 211 2307045] iter: 410, total_loss: 0.08159567415714264, loss_1: 0.1446533203125, loss_2: 0.093994140625, loss_3: 0.0180816650390625
[2025-01-06 22:27:45,285 INFO train.py line 211 2307045] iter: 420, total_loss: 0.05386576056480408, loss_1: 0.054779052734375, loss_2: 0.048583984375, loss_3: 0.0335693359375
[2025-01-06 22:27:47,157 INFO train.py line 211 2307045] iter: 430, total_loss: 0.07256487011909485, loss_1: 0.108642578125, loss_2: 0.09814453125, loss_3: 0.01389312744140625
[2025-01-06 22:27:49,015 INFO train.py line 211 2307045] iter: 440, total_loss: 0.044845979660749435, loss_1: 0.0826416015625, loss_2: 0.05072021484375, loss_3: 0.0175323486328125
[2025-01-06 22:27:50,921 INFO train.py line 211 2307045] iter: 450, total_loss: 0.05368678644299507, loss_1: 0.07244873046875, loss_2: 0.059478759765625, loss_3: 0.01390838623046875
[2025-01-06 22:27:52,834 INFO train.py line 211 2307045] iter: 460, total_loss: 0.04500216990709305, loss_1: 0.062408447265625, loss_2: 0.04443359375, loss_3: 0.02069091796875
[2025-01-06 22:27:54,709 INFO train.py line 211 2307045] iter: 470, total_loss: 0.0553041473031044, loss_1: 0.078369140625, loss_2: 0.0626220703125, loss_3: 0.0168304443359375
[2025-01-06 22:27:56,579 INFO train.py line 211 2307045] iter: 480, total_loss: 0.052044738084077835, loss_1: 0.07330322265625, loss_2: 0.07000732421875, loss_3: 0.01971435546875
[2025-01-06 22:27:58,501 INFO train.py line 211 2307045] iter: 490, total_loss: 0.04974222928285599, loss_1: 0.0474853515625, loss_2: 0.03863525390625, loss_3: 0.0338134765625
[2025-01-06 22:28:00,385 INFO train.py line 211 2307045] iter: 500, total_loss: 0.04924561828374863, loss_1: 0.048309326171875, loss_2: 0.04534912109375, loss_3: 0.027923583984375
[2025-01-06 22:28:02,265 INFO train.py line 211 2307045] iter: 510, total_loss: 0.04521534591913223, loss_1: 0.068115234375, loss_2: 0.04840087890625, loss_3: 0.01497650146484375
[2025-01-06 22:28:04,177 INFO train.py line 211 2307045] iter: 520, total_loss: 0.03977823257446289, loss_1: 0.053802490234375, loss_2: 0.0386962890625, loss_3: 0.019317626953125
[2025-01-06 22:28:06,080 INFO train.py line 211 2307045] iter: 530, total_loss: 0.04428679868578911, loss_1: 0.05499267578125, loss_2: 0.0330810546875, loss_3: 0.0236053466796875
[2025-01-06 22:28:07,965 INFO train.py line 211 2307045] iter: 540, total_loss: 0.04187683388590813, loss_1: 0.0648193359375, loss_2: 0.032318115234375, loss_3: 0.0189208984375
[2025-01-06 22:28:09,860 INFO train.py line 211 2307045] iter: 550, total_loss: 0.047176115214824677, loss_1: 0.07659912109375, loss_2: 0.049957275390625, loss_3: 0.00701904296875
[2025-01-06 22:28:11,738 INFO train.py line 211 2307045] iter: 560, total_loss: 0.06829597800970078, loss_1: 0.1451416015625, loss_2: 0.050201416015625, loss_3: 0.018798828125
[2025-01-06 22:28:13,623 INFO train.py line 211 2307045] iter: 570, total_loss: 0.039798855781555176, loss_1: 0.05377197265625, loss_2: 0.0282135009765625, loss_3: 0.0233612060546875
[2025-01-06 22:28:15,523 INFO train.py line 211 2307045] iter: 580, total_loss: 0.04171793907880783, loss_1: 0.048583984375, loss_2: 0.03460693359375, loss_3: 0.024993896484375
[2025-01-06 22:28:17,412 INFO train.py line 211 2307045] iter: 590, total_loss: 0.056146591901779175, loss_1: 0.08856201171875, loss_2: 0.05950927734375, loss_3: 0.011444091796875
[2025-01-06 22:28:19,367 INFO train.py line 211 2307045] iter: 600, total_loss: 0.045149557292461395, loss_1: 0.0753173828125, loss_2: 0.03594970703125, loss_3: 0.0183258056640625
[2025-01-06 22:28:21,306 INFO train.py line 211 2307045] iter: 610, total_loss: 0.05018443986773491, loss_1: 0.07452392578125, loss_2: 0.044921875, loss_3: 0.0200042724609375
[2025-01-06 22:28:23,203 INFO train.py line 211 2307045] iter: 620, total_loss: 0.03500784561038017, loss_1: 0.045745849609375, loss_2: 0.04052734375, loss_3: 0.0166473388671875
[2025-01-06 22:28:25,108 INFO train.py line 211 2307045] iter: 630, total_loss: 0.040137261152267456, loss_1: 0.0595703125, loss_2: 0.03045654296875, loss_3: 0.0203857421875
[2025-01-06 22:28:27,013 INFO train.py line 211 2307045] iter: 640, total_loss: 0.06864411383867264, loss_1: 0.12176513671875, loss_2: 0.06304931640625, loss_3: 0.01422119140625
[2025-01-06 22:28:28,917 INFO train.py line 211 2307045] iter: 650, total_loss: 0.03910233825445175, loss_1: 0.043487548828125, loss_2: 0.037689208984375, loss_3: 0.021942138671875
[2025-01-06 22:28:30,827 INFO train.py line 211 2307045] iter: 660, total_loss: 0.04010683298110962, loss_1: 0.03204345703125, loss_2: 0.02618408203125, loss_3: 0.032440185546875
[2025-01-06 22:28:32,715 INFO train.py line 211 2307045] iter: 670, total_loss: 0.03752753138542175, loss_1: 0.0423583984375, loss_2: 0.038482666015625, loss_3: 0.0197906494140625
[2025-01-06 22:28:34,623 INFO train.py line 211 2307045] iter: 680, total_loss: 0.045134227722883224, loss_1: 0.059417724609375, loss_2: 0.048553466796875, loss_3: 0.019073486328125
[2025-01-06 22:28:36,503 INFO train.py line 211 2307045] iter: 690, total_loss: 0.04036666080355644, loss_1: 0.0758056640625, loss_2: 0.0298004150390625, loss_3: 0.01525115966796875
[2025-01-06 22:28:38,377 INFO train.py line 211 2307045] iter: 700, total_loss: 0.044207990169525146, loss_1: 0.057586669921875, loss_2: 0.044219970703125, loss_3: 0.017425537109375
[2025-01-06 22:28:40,308 INFO train.py line 211 2307045] iter: 710, total_loss: 0.0826614499092102, loss_1: 0.15625, loss_2: 0.08935546875, loss_3: 0.006328582763671875
[2025-01-06 22:28:42,192 INFO train.py line 211 2307045] iter: 720, total_loss: 0.03478465974330902, loss_1: 0.039642333984375, loss_2: 0.0357666015625, loss_3: 0.0169830322265625
[2025-01-06 22:28:44,117 INFO train.py line 211 2307045] iter: 730, total_loss: 0.03798448666930199, loss_1: 0.0750732421875, loss_2: 0.037811279296875, loss_3: 0.00962066650390625
[2025-01-06 22:28:46,045 INFO train.py line 211 2307045] iter: 740, total_loss: 0.05045642331242561, loss_1: 0.05621337890625, loss_2: 0.04388427734375, loss_3: 0.0258636474609375
[2025-01-06 22:28:47,970 INFO train.py line 211 2307045] iter: 750, total_loss: 0.03616708517074585, loss_1: 0.03314208984375, loss_2: 0.0210723876953125, loss_3: 0.0286102294921875
[2025-01-06 22:28:49,854 INFO train.py line 211 2307045] iter: 760, total_loss: 0.037620801478624344, loss_1: 0.05450439453125, loss_2: 0.0238189697265625, loss_3: 0.0210113525390625
[2025-01-06 22:28:51,786 INFO train.py line 211 2307045] iter: 770, total_loss: 0.05205228179693222, loss_1: 0.06890869140625, loss_2: 0.0660400390625, loss_3: 0.0168304443359375
[2025-01-06 22:28:53,689 INFO train.py line 211 2307045] iter: 780, total_loss: 0.03867523372173309, loss_1: 0.03350830078125, loss_2: 0.02734375, loss_3: 0.0299224853515625
[2025-01-06 22:28:55,594 INFO train.py line 211 2307045] iter: 790, total_loss: 0.03663790225982666, loss_1: 0.035400390625, loss_2: 0.033843994140625, loss_3: 0.0231170654296875
[2025-01-06 22:28:57,526 INFO train.py line 211 2307045] iter: 800, total_loss: 0.03901822865009308, loss_1: 0.045379638671875, loss_2: 0.04095458984375, loss_3: 0.0207366943359375
[2025-01-06 22:28:59,441 INFO train.py line 211 2307045] iter: 810, total_loss: 0.03440238907933235, loss_1: 0.03961181640625, loss_2: 0.0220489501953125, loss_3: 0.025543212890625
[2025-01-06 22:29:01,366 INFO train.py line 211 2307045] iter: 820, total_loss: 0.05601051449775696, loss_1: 0.11297607421875, loss_2: 0.0487060546875, loss_3: 0.0211029052734375
[2025-01-06 22:29:03,223 INFO train.py line 211 2307045] iter: 830, total_loss: 0.03318610414862633, loss_1: 0.047088623046875, loss_2: 0.0197601318359375, loss_3: 0.0196380615234375
[2025-01-06 22:29:05,133 INFO train.py line 211 2307045] iter: 840, total_loss: 0.04741228371858597, loss_1: 0.06353759765625, loss_2: 0.045684814453125, loss_3: 0.018707275390625
[2025-01-06 22:29:07,021 INFO train.py line 211 2307045] iter: 850, total_loss: 0.036341097205877304, loss_1: 0.048187255859375, loss_2: 0.0241546630859375, loss_3: 0.019927978515625
[2025-01-06 22:29:08,940 INFO train.py line 211 2307045] iter: 860, total_loss: 0.03507198393344879, loss_1: 0.062286376953125, loss_2: 0.044677734375, loss_3: 0.006328582763671875
[2025-01-06 22:29:10,854 INFO train.py line 211 2307045] iter: 870, total_loss: 0.046374447643756866, loss_1: 0.10498046875, loss_2: 0.031494140625, loss_3: 0.0035572052001953125
[2025-01-06 22:29:12,764 INFO train.py line 211 2307045] iter: 880, total_loss: 0.029774323105812073, loss_1: 0.02972412109375, loss_2: 0.0195770263671875, loss_3: 0.0225677490234375
[2025-01-06 22:29:14,673 INFO train.py line 211 2307045] iter: 890, total_loss: 0.02766593173146248, loss_1: 0.031646728515625, loss_2: 0.0179290771484375, loss_3: 0.018157958984375
[2025-01-06 22:29:16,569 INFO train.py line 211 2307045] iter: 900, total_loss: 0.036762580275535583, loss_1: 0.026641845703125, loss_2: 0.017669677734375, loss_3: 0.0343017578125
[2025-01-06 22:29:18,503 INFO train.py line 211 2307045] iter: 910, total_loss: 0.04307529330253601, loss_1: 0.061798095703125, loss_2: 0.038482666015625, loss_3: 0.022308349609375
[2025-01-06 22:29:20,434 INFO train.py line 211 2307045] iter: 920, total_loss: 0.04786999523639679, loss_1: 0.04803466796875, loss_2: 0.02178955078125, loss_3: 0.041900634765625
[2025-01-06 22:29:22,360 INFO train.py line 211 2307045] iter: 930, total_loss: 0.03899354487657547, loss_1: 0.0518798828125, loss_2: 0.041595458984375, loss_3: 0.0187530517578125
[2025-01-06 22:29:24,254 INFO train.py line 211 2307045] iter: 940, total_loss: 0.03656284883618355, loss_1: 0.056671142578125, loss_2: 0.046905517578125, loss_3: 0.01218414306640625
[2025-01-06 22:29:26,157 INFO train.py line 211 2307045] iter: 950, total_loss: 0.04368636757135391, loss_1: 0.046478271484375, loss_2: 0.0430908203125, loss_3: 0.025146484375
[2025-01-06 22:29:28,034 INFO train.py line 211 2307045] iter: 960, total_loss: 0.046142227947711945, loss_1: 0.051788330078125, loss_2: 0.048553466796875, loss_3: 0.022979736328125
[2025-01-06 22:29:29,944 INFO train.py line 211 2307045] iter: 970, total_loss: 0.07538492232561111, loss_1: 0.1357421875, loss_2: 0.06121826171875, loss_3: 0.005207061767578125
[2025-01-06 22:29:31,836 INFO train.py line 211 2307045] iter: 980, total_loss: 0.05331543833017349, loss_1: 0.123291015625, loss_2: 0.0234375, loss_3: 0.0131683349609375
[2025-01-06 22:29:33,754 INFO train.py line 211 2307045] iter: 990, total_loss: 0.0352557972073555, loss_1: 0.052886962890625, loss_2: 0.04522705078125, loss_3: 0.01308441162109375
[2025-01-06 22:29:35,644 INFO train.py line 211 2307045] iter: 1000, total_loss: 0.029790440574288368, loss_1: 0.0259552001953125, loss_2: 0.01751708984375, loss_3: 0.024261474609375
[2025-01-06 22:29:37,547 INFO train.py line 211 2307045] iter: 1010, total_loss: 0.03991174325346947, loss_1: 0.05133056640625, loss_2: 0.043670654296875, loss_3: 0.01763916015625
[2025-01-06 22:29:39,468 INFO train.py line 211 2307045] iter: 1020, total_loss: 0.03775572031736374, loss_1: 0.044219970703125, loss_2: 0.03350830078125, loss_3: 0.02130126953125
[2025-01-06 22:29:41,371 INFO train.py line 211 2307045] iter: 1030, total_loss: 0.030980322510004044, loss_1: 0.042388916015625, loss_2: 0.01910400390625, loss_3: 0.018157958984375
[2025-01-06 22:29:43,323 INFO train.py line 211 2307045] iter: 1040, total_loss: 0.02808097004890442, loss_1: 0.035552978515625, loss_2: 0.022186279296875, loss_3: 0.018798828125
[2025-01-06 22:29:45,239 INFO train.py line 211 2307045] iter: 1050, total_loss: 0.046112559735774994, loss_1: 0.08624267578125, loss_2: 0.043182373046875, loss_3: 0.005603790283203125
[2025-01-06 22:29:47,124 INFO train.py line 211 2307045] iter: 1060, total_loss: 0.038977235555648804, loss_1: 0.04949951171875, loss_2: 0.043701171875, loss_3: 0.0178070068359375
[2025-01-06 22:29:49,031 INFO train.py line 211 2307045] iter: 1070, total_loss: 0.032269418239593506, loss_1: 0.031768798828125, loss_2: 0.0179443359375, loss_3: 0.0259246826171875
[2025-01-06 22:29:50,944 INFO train.py line 211 2307045] iter: 1080, total_loss: 0.02614048309624195, loss_1: 0.0280609130859375, loss_2: 0.0230865478515625, loss_3: 0.016265869140625
[2025-01-06 22:29:52,793 INFO train.py line 211 2307045] iter: 1090, total_loss: 0.042678698897361755, loss_1: 0.045989990234375, loss_2: 0.042022705078125, loss_3: 0.02496337890625
[2025-01-06 22:29:54,676 INFO train.py line 211 2307045] iter: 1100, total_loss: 0.033746905624866486, loss_1: 0.046142578125, loss_2: 0.0292816162109375, loss_3: 0.0190582275390625
[2025-01-06 22:29:56,564 INFO train.py line 211 2307045] iter: 1110, total_loss: 0.05145951360464096, loss_1: 0.0826416015625, loss_2: 0.059356689453125, loss_3: 0.01222991943359375
[2025-01-06 22:29:58,525 INFO train.py line 211 2307045] iter: 1120, total_loss: 0.037212733179330826, loss_1: 0.07373046875, loss_2: 0.0215911865234375, loss_3: 0.01560211181640625
[2025-01-06 22:30:00,479 INFO train.py line 211 2307045] iter: 1130, total_loss: 0.03476420044898987, loss_1: 0.0477294921875, loss_2: 0.017974853515625, loss_3: 0.0216522216796875
[2025-01-06 22:30:02,482 INFO train.py line 211 2307045] iter: 1140, total_loss: 0.036411575973033905, loss_1: 0.036895751953125, loss_2: 0.03387451171875, loss_3: 0.023712158203125
[2025-01-06 22:30:04,420 INFO train.py line 211 2307045] iter: 1150, total_loss: 0.024076804518699646, loss_1: 0.03515625, loss_2: 0.0192413330078125, loss_3: 0.006702423095703125
[2025-01-06 22:30:06,353 INFO train.py line 211 2307045] iter: 1160, total_loss: 0.03206579387187958, loss_1: 0.03497314453125, loss_2: 0.033599853515625, loss_3: 0.0201416015625
[2025-01-06 22:30:08,286 INFO train.py line 211 2307045] iter: 1170, total_loss: 0.03709748014807701, loss_1: 0.080322265625, loss_2: 0.02490234375, loss_3: 0.0116729736328125
[2025-01-06 22:30:10,184 INFO train.py line 211 2307045] iter: 1180, total_loss: 0.03270795941352844, loss_1: 0.049285888671875, loss_2: 0.0137481689453125, loss_3: 0.0194854736328125
[2025-01-06 22:30:12,100 INFO train.py line 211 2307045] iter: 1190, total_loss: 0.03540071099996567, loss_1: 0.042999267578125, loss_2: 0.040283203125, loss_3: 0.0171051025390625
[2025-01-06 22:30:14,019 INFO train.py line 211 2307045] iter: 1200, total_loss: 0.028395894914865494, loss_1: 0.04254150390625, loss_2: 0.017425537109375, loss_3: 0.01557159423828125
[2025-01-06 22:30:15,900 INFO train.py line 211 2307045] iter: 1210, total_loss: 0.034843094646930695, loss_1: 0.039337158203125, loss_2: 0.015899658203125, loss_3: 0.026763916015625
[2025-01-06 22:30:17,801 INFO train.py line 211 2307045] iter: 1220, total_loss: 0.02614656090736389, loss_1: 0.03436279296875, loss_2: 0.0136566162109375, loss_3: 0.017303466796875
[2025-01-06 22:30:19,686 INFO train.py line 211 2307045] iter: 1230, total_loss: 0.03314719721674919, loss_1: 0.04327392578125, loss_2: 0.0198516845703125, loss_3: 0.02142333984375
[2025-01-06 22:30:21,588 INFO train.py line 211 2307045] iter: 1240, total_loss: 0.03448684886097908, loss_1: 0.031982421875, loss_2: 0.0304412841796875, loss_3: 0.0218048095703125
[2025-01-06 22:30:23,489 INFO train.py line 211 2307045] iter: 1250, total_loss: 0.03844790905714035, loss_1: 0.052001953125, loss_2: 0.03924560546875, loss_3: 0.0170745849609375
[2025-01-06 22:30:25,392 INFO train.py line 211 2307045] iter: 1260, total_loss: 0.03967621922492981, loss_1: 0.045135498046875, loss_2: 0.034393310546875, loss_3: 0.0219573974609375
[2025-01-06 22:30:27,287 INFO train.py line 211 2307045] iter: 1270, total_loss: 0.029520023614168167, loss_1: 0.041656494140625, loss_2: 0.0146331787109375, loss_3: 0.0179595947265625
[2025-01-06 22:30:29,167 INFO train.py line 211 2307045] iter: 1280, total_loss: 0.030536551028490067, loss_1: 0.049468994140625, loss_2: 0.019073486328125, loss_3: 0.01611328125
[2025-01-06 22:30:31,051 INFO train.py line 211 2307045] iter: 1290, total_loss: 0.03619873896241188, loss_1: 0.0411376953125, loss_2: 0.0224151611328125, loss_3: 0.0239715576171875
[2025-01-06 22:30:32,958 INFO train.py line 211 2307045] iter: 1300, total_loss: 0.03514104709029198, loss_1: 0.0623779296875, loss_2: 0.020965576171875, loss_3: 0.01617431640625
[2025-01-06 22:30:34,852 INFO train.py line 211 2307045] iter: 1310, total_loss: 0.023869523778557777, loss_1: 0.035797119140625, loss_2: 0.013824462890625, loss_3: 0.01392364501953125
[2025-01-06 22:30:36,776 INFO train.py line 211 2307045] iter: 1320, total_loss: 0.019559785723686218, loss_1: 0.0277557373046875, loss_2: 0.0168609619140625, loss_3: 0.007579803466796875
[2025-01-06 22:30:38,692 INFO train.py line 211 2307045] iter: 1330, total_loss: 0.04099900275468826, loss_1: 0.0697021484375, loss_2: 0.051727294921875, loss_3: 0.006221771240234375
[2025-01-06 22:30:40,608 INFO train.py line 211 2307045] iter: 1340, total_loss: 0.028183870017528534, loss_1: 0.03216552734375, loss_2: 0.01558685302734375, loss_3: 0.02069091796875
[2025-01-06 22:30:42,508 INFO train.py line 211 2307045] iter: 1350, total_loss: 0.03334449976682663, loss_1: 0.062744140625, loss_2: 0.0292510986328125, loss_3: 0.01290130615234375
[2025-01-06 22:30:44,403 INFO train.py line 211 2307045] iter: 1360, total_loss: 0.02807452157139778, loss_1: 0.03411865234375, loss_2: 0.0150146484375, loss_3: 0.0183563232421875
[2025-01-06 22:30:46,286 INFO train.py line 211 2307045] iter: 1370, total_loss: 0.036019131541252136, loss_1: 0.040283203125, loss_2: 0.037322998046875, loss_3: 0.0172119140625
[2025-01-06 22:30:48,177 INFO train.py line 211 2307045] iter: 1380, total_loss: 0.030293209478259087, loss_1: 0.052337646484375, loss_2: 0.01261138916015625, loss_3: 0.01540374755859375
[2025-01-06 22:30:50,112 INFO train.py line 211 2307045] iter: 1390, total_loss: 0.032164737582206726, loss_1: 0.054168701171875, loss_2: 0.01546478271484375, loss_3: 0.01522064208984375
[2025-01-06 22:30:52,033 INFO train.py line 211 2307045] iter: 1400, total_loss: 0.041302405297756195, loss_1: 0.054290771484375, loss_2: 0.03594970703125, loss_3: 0.0212860107421875
[2025-01-06 22:30:53,973 INFO train.py line 211 2307045] iter: 1410, total_loss: 0.0490938201546669, loss_1: 0.0792236328125, loss_2: 0.045806884765625, loss_3: 0.01910400390625
[2025-01-06 22:30:55,893 INFO train.py line 211 2307045] iter: 1420, total_loss: 0.033407390117645264, loss_1: 0.03778076171875, loss_2: 0.033447265625, loss_3: 0.018798828125
[2025-01-06 22:30:57,791 INFO train.py line 211 2307045] iter: 1430, total_loss: 0.03361497074365616, loss_1: 0.042724609375, loss_2: 0.037811279296875, loss_3: 0.0140380859375
[2025-01-06 22:30:59,681 INFO train.py line 211 2307045] iter: 1440, total_loss: 0.038583822548389435, loss_1: 0.05596923828125, loss_2: 0.044464111328125, loss_3: 0.006526947021484375
[2025-01-06 22:31:01,588 INFO train.py line 211 2307045] iter: 1450, total_loss: 0.032952312380075455, loss_1: 0.037994384765625, loss_2: 0.033355712890625, loss_3: 0.0177459716796875
[2025-01-06 22:31:03,484 INFO train.py line 211 2307045] iter: 1460, total_loss: 0.021198682487010956, loss_1: 0.0265350341796875, loss_2: 0.02056884765625, loss_3: 0.006805419921875
[2025-01-06 22:31:05,384 INFO train.py line 211 2307045] iter: 1470, total_loss: 0.030687471851706505, loss_1: 0.040557861328125, loss_2: 0.016876220703125, loss_3: 0.0199432373046875
[2025-01-06 22:31:07,280 INFO train.py line 211 2307045] iter: 1480, total_loss: 0.026128405705094337, loss_1: 0.0311737060546875, loss_2: 0.0249176025390625, loss_3: 0.0164794921875
[2025-01-06 22:31:09,215 INFO train.py line 211 2307045] iter: 1490, total_loss: 0.04761962220072746, loss_1: 0.06988525390625, loss_2: 0.0645751953125, loss_3: 0.004795074462890625
[2025-01-06 22:31:11,127 INFO train.py line 211 2307045] iter: 1500, total_loss: 0.03443140536546707, loss_1: 0.05035400390625, loss_2: 0.035125732421875, loss_3: 0.01328277587890625
[2025-01-06 22:31:13,062 INFO train.py line 211 2307045] iter: 1510, total_loss: 0.03963858634233475, loss_1: 0.046722412109375, loss_2: 0.0277557373046875, loss_3: 0.0263671875
[2025-01-06 22:31:15,015 INFO train.py line 211 2307045] iter: 1520, total_loss: 0.031866081058979034, loss_1: 0.0589599609375, loss_2: 0.03125, loss_3: 0.005321502685546875
[2025-01-06 22:33:13,360 INFO train.py line 133 2317199] => Loading config ...
[2025-01-06 22:33:13,360 INFO train.py line 135 2317199] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 22:33:13,663 INFO train.py line 136 2317199] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 15493614
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 22:33:13,663 INFO train.py line 137 2317199] => Building model ...
[2025-01-06 22:33:14,308 INFO train.py line 425 2317199] Num params: 1634304
[2025-01-06 22:33:14,379 INFO train.py line 139 2317199] => Building writer ...
[2025-01-06 22:33:14,390 INFO train.py line 435 2317199] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 22:33:14,390 INFO train.py line 141 2317199] => Building train dataset & dataloader ...
[2025-01-06 22:33:55,186 INFO dataset_render_16views.py line 145 2317199] Processing frame_0
[2025-01-06 22:33:57,794 INFO dataset_render_16views.py line 145 2317199] Processing frame_1
[2025-01-06 22:34:00,369 INFO dataset_render_16views.py line 145 2317199] Processing frame_2
[2025-01-06 22:34:02,700 INFO dataset_render_16views.py line 145 2317199] Processing frame_3
[2025-01-06 22:34:05,079 INFO dataset_render_16views.py line 145 2317199] Processing frame_4
[2025-01-06 22:34:07,531 INFO dataset_render_16views.py line 145 2317199] Processing frame_5
[2025-01-06 22:34:09,775 INFO dataset_render_16views.py line 145 2317199] Processing frame_6
[2025-01-06 22:34:12,003 INFO dataset_render_16views.py line 145 2317199] Processing frame_7
[2025-01-06 22:34:14,337 INFO dataset_render_16views.py line 145 2317199] Processing frame_8
[2025-01-06 22:34:16,883 INFO dataset_render_16views.py line 145 2317199] Processing frame_9
[2025-01-06 22:34:19,208 INFO dataset_render_16views.py line 145 2317199] Processing frame_10
[2025-01-06 22:34:21,458 INFO dataset_render_16views.py line 145 2317199] Processing frame_11
[2025-01-06 22:34:23,709 INFO dataset_render_16views.py line 145 2317199] Processing frame_12
[2025-01-06 22:34:26,161 INFO dataset_render_16views.py line 145 2317199] Processing frame_13
[2025-01-06 22:34:28,448 INFO dataset_render_16views.py line 145 2317199] Processing frame_14
[2025-01-06 22:34:30,775 INFO dataset_render_16views.py line 145 2317199] Processing frame_15
[2025-01-06 22:34:33,085 INFO dataset_render_16views.py line 69 2317199] Totally 16 x 1 samples in train set.
[2025-01-06 22:34:33,085 INFO train.py line 145 2317199] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 22:34:33,086 INFO optimizer.py line 64 2317199] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 22:34:33,087 INFO train.py line 149 2317199] => Building hooks ...
[2025-01-06 22:34:33,088 INFO train.py line 166 2317199] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 22:34:33,088 INFO train.py line 171 2317199] => Loading checkpoint & weight ...
[2025-01-06 22:34:33,255 INFO train.py line 192 2317199] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 22:34:33,786 INFO train.py line 211 2317199] iter: 0, total_loss: 0.49255502223968506, loss_1: 0.439208984375, loss_2: 0.43896484375, loss_3: 0.28369140625
[2025-01-06 22:34:35,736 INFO train.py line 211 2317199] iter: 10, total_loss: 0.3868725597858429, loss_1: 0.413818359375, loss_2: 0.4111328125, loss_3: 0.2242431640625
[2025-01-06 22:34:37,641 INFO train.py line 211 2317199] iter: 20, total_loss: 0.3410813808441162, loss_1: 0.4013671875, loss_2: 0.391357421875, loss_3: 0.1334228515625
[2025-01-06 22:34:39,507 INFO train.py line 211 2317199] iter: 30, total_loss: 0.23278802633285522, loss_1: 0.36181640625, loss_2: 0.34326171875, loss_3: 0.05743408203125
[2025-01-06 22:34:41,410 INFO train.py line 211 2317199] iter: 40, total_loss: 0.1695353388786316, loss_1: 0.268310546875, loss_2: 0.2354736328125, loss_3: 0.045074462890625
[2025-01-06 22:34:43,320 INFO train.py line 211 2317199] iter: 50, total_loss: 0.17748889327049255, loss_1: 0.25830078125, loss_2: 0.255126953125, loss_3: 0.0311737060546875
[2025-01-06 22:34:45,246 INFO train.py line 211 2317199] iter: 60, total_loss: 0.1406027376651764, loss_1: 0.226806640625, loss_2: 0.1302490234375, loss_3: 0.0474853515625
[2025-01-06 22:34:47,164 INFO train.py line 211 2317199] iter: 70, total_loss: 0.1156352087855339, loss_1: 0.1497802734375, loss_2: 0.1309814453125, loss_3: 0.042327880859375
[2025-01-06 22:34:49,023 INFO train.py line 211 2317199] iter: 80, total_loss: 0.10172867774963379, loss_1: 0.1903076171875, loss_2: 0.10638427734375, loss_3: 0.0293121337890625
[2025-01-06 22:34:50,886 INFO train.py line 211 2317199] iter: 90, total_loss: 0.09945148229598999, loss_1: 0.10760498046875, loss_2: 0.08709716796875, loss_3: 0.0565185546875
[2025-01-06 22:34:52,769 INFO train.py line 211 2317199] iter: 100, total_loss: 0.1677505522966385, loss_1: 0.23486328125, loss_2: 0.1915283203125, loss_3: 0.00890350341796875
[2025-01-06 22:34:54,668 INFO train.py line 211 2317199] iter: 110, total_loss: 0.10707748681306839, loss_1: 0.14697265625, loss_2: 0.11236572265625, loss_3: 0.0296478271484375
[2025-01-06 22:34:56,574 INFO train.py line 211 2317199] iter: 120, total_loss: 0.10792003571987152, loss_1: 0.1531982421875, loss_2: 0.1453857421875, loss_3: 0.0218353271484375
[2025-01-06 22:34:58,456 INFO train.py line 211 2317199] iter: 130, total_loss: 0.1183118000626564, loss_1: 0.165771484375, loss_2: 0.12396240234375, loss_3: 0.00775146484375
[2025-01-06 22:35:00,328 INFO train.py line 211 2317199] iter: 140, total_loss: 0.08796879649162292, loss_1: 0.1282958984375, loss_2: 0.11456298828125, loss_3: 0.0211029052734375
[2025-01-06 22:35:02,216 INFO train.py line 211 2317199] iter: 150, total_loss: 0.07773277908563614, loss_1: 0.1365966796875, loss_2: 0.08636474609375, loss_3: 0.0157012939453125
[2025-01-06 22:35:04,077 INFO train.py line 211 2317199] iter: 160, total_loss: 0.07268298417329788, loss_1: 0.123779296875, loss_2: 0.053955078125, loss_3: 0.016448974609375
[2025-01-06 22:35:05,927 INFO train.py line 211 2317199] iter: 170, total_loss: 0.060350798070430756, loss_1: 0.07330322265625, loss_2: 0.061309814453125, loss_3: 0.026519775390625
[2025-01-06 22:35:07,797 INFO train.py line 211 2317199] iter: 180, total_loss: 0.07230979204177856, loss_1: 0.060699462890625, loss_2: 0.050506591796875, loss_3: 0.05810546875
[2025-01-06 22:35:09,640 INFO train.py line 211 2317199] iter: 190, total_loss: 0.0670790746808052, loss_1: 0.112548828125, loss_2: 0.064208984375, loss_3: 0.0215301513671875
[2025-01-06 22:35:11,550 INFO train.py line 211 2317199] iter: 200, total_loss: 0.10524632036685944, loss_1: 0.16259765625, loss_2: 0.1541748046875, loss_3: 0.0168914794921875
[2025-01-06 22:35:13,435 INFO train.py line 211 2317199] iter: 210, total_loss: 0.07653553038835526, loss_1: 0.0953369140625, loss_2: 0.08453369140625, loss_3: 0.0316162109375
[2025-01-06 22:35:15,303 INFO train.py line 211 2317199] iter: 220, total_loss: 0.0650966465473175, loss_1: 0.07440185546875, loss_2: 0.072265625, loss_3: 0.031585693359375
[2025-01-06 22:35:17,178 INFO train.py line 211 2317199] iter: 230, total_loss: 0.07699757069349289, loss_1: 0.14208984375, loss_2: 0.07379150390625, loss_3: 0.017791748046875
[2025-01-06 22:35:19,037 INFO train.py line 211 2317199] iter: 240, total_loss: 0.06586455553770065, loss_1: 0.09075927734375, loss_2: 0.0823974609375, loss_3: 0.0192108154296875
[2025-01-06 22:35:20,924 INFO train.py line 211 2317199] iter: 250, total_loss: 0.06938596069812775, loss_1: 0.07513427734375, loss_2: 0.0731201171875, loss_3: 0.034912109375
[2025-01-06 22:35:22,795 INFO train.py line 211 2317199] iter: 260, total_loss: 0.06065833568572998, loss_1: 0.09051513671875, loss_2: 0.05706787109375, loss_3: 0.0233001708984375
[2025-01-06 22:35:24,673 INFO train.py line 211 2317199] iter: 270, total_loss: 0.09905482083559036, loss_1: 0.1630859375, loss_2: 0.1422119140625, loss_3: 0.00531768798828125
[2025-01-06 22:35:26,554 INFO train.py line 211 2317199] iter: 280, total_loss: 0.06454955041408539, loss_1: 0.101318359375, loss_2: 0.088134765625, loss_3: 0.0081634521484375
[2025-01-06 22:35:28,435 INFO train.py line 211 2317199] iter: 290, total_loss: 0.04946409910917282, loss_1: 0.06280517578125, loss_2: 0.0430908203125, loss_3: 0.0276947021484375
[2025-01-06 22:35:30,296 INFO train.py line 211 2317199] iter: 300, total_loss: 0.06047823280096054, loss_1: 0.08306884765625, loss_2: 0.076171875, loss_3: 0.0195770263671875
[2025-01-06 22:35:32,141 INFO train.py line 211 2317199] iter: 310, total_loss: 0.057114001363515854, loss_1: 0.11383056640625, loss_2: 0.055755615234375, loss_3: 0.0162506103515625
[2025-01-06 22:35:34,024 INFO train.py line 211 2317199] iter: 320, total_loss: 0.06295307725667953, loss_1: 0.11639404296875, loss_2: 0.0623779296875, loss_3: 0.019195556640625
[2025-01-06 22:35:35,918 INFO train.py line 211 2317199] iter: 330, total_loss: 0.049188192933797836, loss_1: 0.08929443359375, loss_2: 0.044952392578125, loss_3: 0.0212249755859375
[2025-01-06 22:35:37,827 INFO train.py line 211 2317199] iter: 340, total_loss: 0.05467543005943298, loss_1: 0.0765380859375, loss_2: 0.043853759765625, loss_3: 0.024383544921875
[2025-01-06 22:35:39,733 INFO train.py line 211 2317199] iter: 350, total_loss: 0.048957280814647675, loss_1: 0.0941162109375, loss_2: 0.039703369140625, loss_3: 0.01479339599609375
[2025-01-06 22:35:41,618 INFO train.py line 211 2317199] iter: 360, total_loss: 0.05599021166563034, loss_1: 0.048492431640625, loss_2: 0.036468505859375, loss_3: 0.04498291015625
[2025-01-06 22:35:43,482 INFO train.py line 211 2317199] iter: 370, total_loss: 0.11663088202476501, loss_1: 0.266845703125, loss_2: 0.11773681640625, loss_3: 0.004650115966796875
[2025-01-06 22:35:45,382 INFO train.py line 211 2317199] iter: 380, total_loss: 0.04767459258437157, loss_1: 0.057830810546875, loss_2: 0.05267333984375, loss_3: 0.025543212890625
[2025-01-06 22:35:47,277 INFO train.py line 211 2317199] iter: 390, total_loss: 0.06068912521004677, loss_1: 0.10247802734375, loss_2: 0.05877685546875, loss_3: 0.0186920166015625
[2025-01-06 22:35:49,143 INFO train.py line 211 2317199] iter: 400, total_loss: 0.057633645832538605, loss_1: 0.07073974609375, loss_2: 0.07025146484375, loss_3: 0.023345947265625
[2025-01-06 22:35:51,015 INFO train.py line 211 2317199] iter: 410, total_loss: 0.08765491098165512, loss_1: 0.15966796875, loss_2: 0.10626220703125, loss_3: 0.0174560546875
[2025-01-06 22:35:52,894 INFO train.py line 211 2317199] iter: 420, total_loss: 0.055062055587768555, loss_1: 0.07135009765625, loss_2: 0.06243896484375, loss_3: 0.0199737548828125
[2025-01-06 22:35:54,789 INFO train.py line 211 2317199] iter: 430, total_loss: 0.06040562689304352, loss_1: 0.0718994140625, loss_2: 0.060760498046875, loss_3: 0.0245819091796875
[2025-01-06 22:35:56,695 INFO train.py line 211 2317199] iter: 440, total_loss: 0.07850965857505798, loss_1: 0.11273193359375, loss_2: 0.10479736328125, loss_3: 0.005008697509765625
[2025-01-06 22:35:58,577 INFO train.py line 211 2317199] iter: 450, total_loss: 0.04441928490996361, loss_1: 0.08050537109375, loss_2: 0.034881591796875, loss_3: 0.0168609619140625
[2025-01-06 22:36:00,459 INFO train.py line 211 2317199] iter: 460, total_loss: 0.04936213046312332, loss_1: 0.09423828125, loss_2: 0.044830322265625, loss_3: 0.0061492919921875
[2025-01-06 22:36:02,319 INFO train.py line 211 2317199] iter: 470, total_loss: 0.05717480182647705, loss_1: 0.07733154296875, loss_2: 0.06732177734375, loss_3: 0.018096923828125
[2025-01-06 22:36:04,187 INFO train.py line 211 2317199] iter: 480, total_loss: 0.05033275485038757, loss_1: 0.077392578125, loss_2: 0.0352783203125, loss_3: 0.0248565673828125
[2025-01-06 22:36:06,065 INFO train.py line 211 2317199] iter: 490, total_loss: 0.08586118370294571, loss_1: 0.12445068359375, loss_2: 0.10528564453125, loss_3: 0.00759124755859375
[2025-01-06 22:36:07,804 INFO train.py line 248 2317199] => Loading checkpoint & weight ...
[2025-01-06 22:36:07,804 INFO train.py line 257 2317199] No weight found at: None
[2025-01-06 22:36:08,271 INFO train.py line 324 2317199] scale_0.0 has 32 groups
[2025-01-06 22:36:08,660 INFO train.py line 324 2317199] scale_0.5 has 29 groups
[2025-01-06 22:36:09,047 INFO train.py line 324 2317199] scale_1.0 has 28 groups
[2025-01-06 22:36:09,441 INFO train.py line 324 2317199] scale_1.5 has 19 groups
[2025-01-06 22:36:09,843 INFO train.py line 324 2317199] scale_2.0 has 3 groups
[2025-01-06 23:22:09,493 INFO train.py line 133 2360835] => Loading config ...
[2025-01-06 23:22:09,493 INFO train.py line 135 2360835] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:22:09,790 INFO train.py line 136 2360835] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 11731899
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:22:09,790 INFO train.py line 137 2360835] => Building model ...
[2025-01-06 23:22:10,385 INFO train.py line 425 2360835] Num params: 1634304
[2025-01-06 23:22:10,456 INFO train.py line 139 2360835] => Building writer ...
[2025-01-06 23:22:10,466 INFO train.py line 435 2360835] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:22:10,466 INFO train.py line 141 2360835] => Building train dataset & dataloader ...
[2025-01-06 23:22:51,265 INFO dataset_render_16views.py line 145 2360835] Processing frame_0
[2025-01-06 23:22:53,897 INFO dataset_render_16views.py line 145 2360835] Processing frame_1
[2025-01-06 23:22:56,406 INFO dataset_render_16views.py line 145 2360835] Processing frame_2
[2025-01-06 23:22:58,755 INFO dataset_render_16views.py line 145 2360835] Processing frame_3
[2025-01-06 23:23:01,129 INFO dataset_render_16views.py line 145 2360835] Processing frame_4
[2025-01-06 23:23:03,552 INFO dataset_render_16views.py line 145 2360835] Processing frame_5
[2025-01-06 23:23:05,865 INFO dataset_render_16views.py line 145 2360835] Processing frame_6
[2025-01-06 23:23:08,083 INFO dataset_render_16views.py line 145 2360835] Processing frame_7
[2025-01-06 23:23:10,433 INFO dataset_render_16views.py line 145 2360835] Processing frame_8
[2025-01-06 23:23:12,974 INFO dataset_render_16views.py line 145 2360835] Processing frame_9
[2025-01-06 23:23:15,321 INFO dataset_render_16views.py line 145 2360835] Processing frame_10
[2025-01-06 23:23:17,664 INFO dataset_render_16views.py line 145 2360835] Processing frame_11
[2025-01-06 23:23:19,931 INFO dataset_render_16views.py line 145 2360835] Processing frame_12
[2025-01-06 23:23:22,399 INFO dataset_render_16views.py line 145 2360835] Processing frame_13
[2025-01-06 23:23:24,633 INFO dataset_render_16views.py line 145 2360835] Processing frame_14
[2025-01-06 23:23:26,913 INFO dataset_render_16views.py line 145 2360835] Processing frame_15
[2025-01-06 23:23:29,221 INFO dataset_render_16views.py line 69 2360835] Totally 16 x 1 samples in train set.
[2025-01-06 23:23:29,221 INFO train.py line 145 2360835] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:23:29,223 INFO optimizer.py line 64 2360835] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:23:29,223 INFO train.py line 149 2360835] => Building hooks ...
[2025-01-06 23:23:29,225 INFO train.py line 166 2360835] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 23:23:29,225 INFO train.py line 171 2360835] => Loading checkpoint & weight ...
[2025-01-06 23:23:29,386 INFO train.py line 192 2360835] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 23:23:29,896 INFO train.py line 211 2360835] iter: 0, total_loss: 0.4575026035308838, loss_1: 0.413330078125, loss_2: 0.4091796875, loss_3: 0.296142578125
[2025-01-06 23:23:31,822 INFO train.py line 211 2360835] iter: 10, total_loss: 0.45611482858657837, loss_1: 0.39794921875, loss_2: 0.40869140625, loss_3: 0.30126953125
[2025-01-06 23:23:33,722 INFO train.py line 211 2360835] iter: 20, total_loss: 0.3432398736476898, loss_1: 0.411865234375, loss_2: 0.409423828125, loss_3: 0.1290283203125
[2025-01-06 23:23:35,622 INFO train.py line 211 2360835] iter: 30, total_loss: 0.2671080231666565, loss_1: 0.368408203125, loss_2: 0.340087890625, loss_3: 0.07135009765625
[2025-01-06 23:23:37,545 INFO train.py line 211 2360835] iter: 40, total_loss: 0.20628780126571655, loss_1: 0.300048828125, loss_2: 0.291015625, loss_3: 0.046539306640625
[2025-01-06 23:23:39,425 INFO train.py line 211 2360835] iter: 50, total_loss: 0.15263968706130981, loss_1: 0.25830078125, loss_2: 0.210205078125, loss_3: 0.0306243896484375
[2025-01-06 23:23:41,280 INFO train.py line 211 2360835] iter: 60, total_loss: 0.11480198800563812, loss_1: 0.174560546875, loss_2: 0.1455078125, loss_3: 0.0340576171875
[2025-01-06 23:23:43,161 INFO train.py line 211 2360835] iter: 70, total_loss: 0.13695695996284485, loss_1: 0.187744140625, loss_2: 0.1807861328125, loss_3: 0.0236358642578125
[2025-01-06 23:23:45,063 INFO train.py line 211 2360835] iter: 80, total_loss: 0.19125087559223175, loss_1: 0.2734375, loss_2: 0.25830078125, loss_3: 0.006412506103515625
[2025-01-06 23:23:46,950 INFO train.py line 211 2360835] iter: 90, total_loss: 0.14175128936767578, loss_1: 0.2120361328125, loss_2: 0.154296875, loss_3: 0.01544952392578125
[2025-01-06 23:23:48,832 INFO train.py line 211 2360835] iter: 100, total_loss: 0.09125324338674545, loss_1: 0.126708984375, loss_2: 0.1075439453125, loss_3: 0.035797119140625
[2025-01-06 23:23:50,721 INFO train.py line 211 2360835] iter: 110, total_loss: 0.07169359177350998, loss_1: 0.0987548828125, loss_2: 0.07745361328125, loss_3: 0.0276947021484375
[2025-01-06 23:23:52,583 INFO train.py line 211 2360835] iter: 120, total_loss: 0.07336234301328659, loss_1: 0.1273193359375, loss_2: 0.08258056640625, loss_3: 0.02032470703125
[2025-01-06 23:23:54,477 INFO train.py line 211 2360835] iter: 130, total_loss: 0.09013226628303528, loss_1: 0.178466796875, loss_2: 0.11846923828125, loss_3: 0.0201568603515625
[2025-01-06 23:23:56,334 INFO train.py line 211 2360835] iter: 140, total_loss: 0.07715804129838943, loss_1: 0.136962890625, loss_2: 0.12384033203125, loss_3: 0.01458740234375
[2025-01-06 23:23:58,199 INFO train.py line 211 2360835] iter: 150, total_loss: 0.09138526022434235, loss_1: 0.1387939453125, loss_2: 0.11798095703125, loss_3: 0.02593994140625
[2025-01-06 23:24:00,084 INFO train.py line 211 2360835] iter: 160, total_loss: 0.09359358251094818, loss_1: 0.08514404296875, loss_2: 0.07855224609375, loss_3: 0.0653076171875
[2025-01-06 23:24:01,970 INFO train.py line 211 2360835] iter: 170, total_loss: 0.057533182203769684, loss_1: 0.0750732421875, loss_2: 0.057708740234375, loss_3: 0.0250244140625
[2025-01-06 23:24:03,854 INFO train.py line 211 2360835] iter: 180, total_loss: 0.08740130811929703, loss_1: 0.1107177734375, loss_2: 0.087646484375, loss_3: 0.0333251953125
[2025-01-06 23:24:05,732 INFO train.py line 211 2360835] iter: 190, total_loss: 0.06972572207450867, loss_1: 0.1070556640625, loss_2: 0.08917236328125, loss_3: 0.02459716796875
[2025-01-06 23:24:07,607 INFO train.py line 211 2360835] iter: 200, total_loss: 0.05979689210653305, loss_1: 0.0960693359375, loss_2: 0.0654296875, loss_3: 0.0208892822265625
[2025-01-06 23:24:09,481 INFO train.py line 211 2360835] iter: 210, total_loss: 0.05788692086935043, loss_1: 0.08209228515625, loss_2: 0.052581787109375, loss_3: 0.02813720703125
[2025-01-06 23:24:11,362 INFO train.py line 211 2360835] iter: 220, total_loss: 0.09044811129570007, loss_1: 0.1348876953125, loss_2: 0.097412109375, loss_3: 0.0189208984375
[2025-01-06 23:24:13,246 INFO train.py line 211 2360835] iter: 230, total_loss: 0.07674411684274673, loss_1: 0.1204833984375, loss_2: 0.09088134765625, loss_3: 0.016082763671875
[2025-01-06 23:24:15,164 INFO train.py line 211 2360835] iter: 240, total_loss: 0.06503337621688843, loss_1: 0.090087890625, loss_2: 0.06549072265625, loss_3: 0.02423095703125
[2025-01-06 23:24:17,052 INFO train.py line 211 2360835] iter: 250, total_loss: 0.06533470749855042, loss_1: 0.0867919921875, loss_2: 0.0782470703125, loss_3: 0.0310516357421875
[2025-01-06 23:24:18,912 INFO train.py line 211 2360835] iter: 260, total_loss: 0.06745613366365433, loss_1: 0.0816650390625, loss_2: 0.07891845703125, loss_3: 0.0207672119140625
[2025-01-06 23:24:20,783 INFO train.py line 211 2360835] iter: 270, total_loss: 0.06586714088916779, loss_1: 0.08502197265625, loss_2: 0.07659912109375, loss_3: 0.0225830078125
[2025-01-06 23:24:22,667 INFO train.py line 211 2360835] iter: 280, total_loss: 0.06084410846233368, loss_1: 0.07818603515625, loss_2: 0.0733642578125, loss_3: 0.0238494873046875
[2025-01-06 23:24:24,548 INFO train.py line 211 2360835] iter: 290, total_loss: 0.06628096103668213, loss_1: 0.07073974609375, loss_2: 0.062103271484375, loss_3: 0.037506103515625
[2025-01-06 23:24:26,430 INFO train.py line 211 2360835] iter: 300, total_loss: 0.05378550663590431, loss_1: 0.08526611328125, loss_2: 0.07098388671875, loss_3: 0.0168914794921875
[2025-01-06 23:24:28,315 INFO train.py line 211 2360835] iter: 310, total_loss: 0.05478603392839432, loss_1: 0.09765625, loss_2: 0.056915283203125, loss_3: 0.00701141357421875
[2025-01-06 23:24:30,198 INFO train.py line 211 2360835] iter: 320, total_loss: 0.06157466769218445, loss_1: 0.08721923828125, loss_2: 0.06988525390625, loss_3: 0.0229339599609375
[2025-01-06 23:24:32,092 INFO train.py line 211 2360835] iter: 330, total_loss: 0.125237375497818, loss_1: 0.251708984375, loss_2: 0.1177978515625, loss_3: 0.0056610107421875
[2025-01-06 23:24:33,983 INFO train.py line 211 2360835] iter: 340, total_loss: 0.07644080370664597, loss_1: 0.11175537109375, loss_2: 0.0841064453125, loss_3: 0.0216827392578125
[2025-01-06 23:24:35,852 INFO train.py line 211 2360835] iter: 350, total_loss: 0.0458107553422451, loss_1: 0.052734375, loss_2: 0.044281005859375, loss_3: 0.0267791748046875
[2025-01-06 23:24:37,743 INFO train.py line 211 2360835] iter: 360, total_loss: 0.052215754985809326, loss_1: 0.0728759765625, loss_2: 0.033203125, loss_3: 0.0248260498046875
[2025-01-06 23:24:39,610 INFO train.py line 211 2360835] iter: 370, total_loss: 0.04641268402338028, loss_1: 0.05645751953125, loss_2: 0.037933349609375, loss_3: 0.0294342041015625
[2025-01-06 23:24:41,480 INFO train.py line 211 2360835] iter: 380, total_loss: 0.04766199737787247, loss_1: 0.051971435546875, loss_2: 0.05108642578125, loss_3: 0.027069091796875
[2025-01-06 23:24:43,362 INFO train.py line 211 2360835] iter: 390, total_loss: 0.05279647931456566, loss_1: 0.09197998046875, loss_2: 0.03936767578125, loss_3: 0.0225982666015625
[2025-01-06 23:24:45,248 INFO train.py line 211 2360835] iter: 400, total_loss: 0.0677884966135025, loss_1: 0.11517333984375, loss_2: 0.08990478515625, loss_3: 0.0192413330078125
[2025-01-06 23:24:47,127 INFO train.py line 211 2360835] iter: 410, total_loss: 0.047729916870594025, loss_1: 0.057342529296875, loss_2: 0.03594970703125, loss_3: 0.0244598388671875
[2025-01-06 23:24:49,002 INFO train.py line 211 2360835] iter: 420, total_loss: 0.046412982046604156, loss_1: 0.05120849609375, loss_2: 0.04351806640625, loss_3: 0.02911376953125
[2025-01-06 23:24:50,877 INFO train.py line 211 2360835] iter: 430, total_loss: 0.04077034443616867, loss_1: 0.05621337890625, loss_2: 0.04345703125, loss_3: 0.0170135498046875
[2025-01-06 23:24:52,788 INFO train.py line 211 2360835] iter: 440, total_loss: 0.04672133922576904, loss_1: 0.055938720703125, loss_2: 0.03387451171875, loss_3: 0.0222930908203125
[2025-01-06 23:24:54,650 INFO train.py line 211 2360835] iter: 450, total_loss: 0.05841105431318283, loss_1: 0.0755615234375, loss_2: 0.07244873046875, loss_3: 0.0231781005859375
[2025-01-06 23:24:56,517 INFO train.py line 211 2360835] iter: 460, total_loss: 0.05862938240170479, loss_1: 0.1048583984375, loss_2: 0.0738525390625, loss_3: 0.013336181640625
[2025-01-06 23:24:58,382 INFO train.py line 211 2360835] iter: 470, total_loss: 0.04687489941716194, loss_1: 0.0894775390625, loss_2: 0.05126953125, loss_3: 0.0156707763671875
[2025-01-06 23:25:00,248 INFO train.py line 211 2360835] iter: 480, total_loss: 0.04486009106040001, loss_1: 0.07763671875, loss_2: 0.04229736328125, loss_3: 0.0199432373046875
[2025-01-06 23:25:02,131 INFO train.py line 211 2360835] iter: 490, total_loss: 0.04930736869573593, loss_1: 0.05999755859375, loss_2: 0.053466796875, loss_3: 0.0237274169921875
[2025-01-06 23:25:03,854 INFO train.py line 248 2360835] => Loading checkpoint & weight ...
[2025-01-06 23:25:03,854 INFO train.py line 257 2360835] No weight found at: None
[2025-01-06 23:25:04,276 INFO train.py line 324 2360835] scale_0.0 has 32 groups
[2025-01-06 23:25:04,672 INFO train.py line 324 2360835] scale_0.5 has 29 groups
[2025-01-06 23:25:05,067 INFO train.py line 324 2360835] scale_1.0 has 28 groups
[2025-01-06 23:25:05,463 INFO train.py line 324 2360835] scale_1.5 has 20 groups
[2025-01-06 23:25:05,868 INFO train.py line 324 2360835] scale_2.0 has 4 groups
[2025-01-06 23:27:49,228 INFO train.py line 133 2367327] => Loading config ...
[2025-01-06 23:27:49,229 INFO train.py line 135 2367327] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:27:49,528 INFO train.py line 136 2367327] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 51448309
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:27:49,528 INFO train.py line 137 2367327] => Building model ...
[2025-01-06 23:27:50,120 INFO train.py line 425 2367327] Num params: 1634304
[2025-01-06 23:27:50,193 INFO train.py line 139 2367327] => Building writer ...
[2025-01-06 23:27:50,203 INFO train.py line 435 2367327] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:27:50,204 INFO train.py line 141 2367327] => Building train dataset & dataloader ...
[2025-01-06 23:28:31,006 INFO dataset_render_16views.py line 145 2367327] Processing frame_0
[2025-01-06 23:28:33,655 INFO dataset_render_16views.py line 145 2367327] Processing frame_1
[2025-01-06 23:28:36,157 INFO dataset_render_16views.py line 145 2367327] Processing frame_2
[2025-01-06 23:28:38,509 INFO dataset_render_16views.py line 145 2367327] Processing frame_3
[2025-01-06 23:28:40,886 INFO dataset_render_16views.py line 145 2367327] Processing frame_4
[2025-01-06 23:28:43,307 INFO dataset_render_16views.py line 145 2367327] Processing frame_5
[2025-01-06 23:28:45,608 INFO dataset_render_16views.py line 145 2367327] Processing frame_6
[2025-01-06 23:28:47,808 INFO dataset_render_16views.py line 145 2367327] Processing frame_7
[2025-01-06 23:28:50,143 INFO dataset_render_16views.py line 145 2367327] Processing frame_8
[2025-01-06 23:28:52,635 INFO dataset_render_16views.py line 145 2367327] Processing frame_9
[2025-01-06 23:28:54,994 INFO dataset_render_16views.py line 145 2367327] Processing frame_10
[2025-01-06 23:28:57,325 INFO dataset_render_16views.py line 145 2367327] Processing frame_11
[2025-01-06 23:28:59,577 INFO dataset_render_16views.py line 145 2367327] Processing frame_12
[2025-01-06 23:29:02,033 INFO dataset_render_16views.py line 145 2367327] Processing frame_13
[2025-01-06 23:29:04,318 INFO dataset_render_16views.py line 145 2367327] Processing frame_14
[2025-01-06 23:29:06,589 INFO dataset_render_16views.py line 145 2367327] Processing frame_15
[2025-01-06 23:29:08,890 INFO dataset_render_16views.py line 69 2367327] Totally 16 x 1 samples in train set.
[2025-01-06 23:29:08,890 INFO train.py line 145 2367327] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:29:08,891 INFO optimizer.py line 64 2367327] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:29:08,891 INFO train.py line 149 2367327] => Building hooks ...
[2025-01-06 23:29:08,893 INFO train.py line 166 2367327] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 23:29:08,893 INFO train.py line 171 2367327] => Loading checkpoint & weight ...
[2025-01-06 23:29:09,042 INFO train.py line 192 2367327] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 23:29:09,550 INFO train.py line 211 2367327] iter: 0, total_loss: 0.5056523680686951, loss_1: 0.4462890625, loss_2: 0.444580078125, loss_3: 0.275146484375
[2025-01-06 23:29:11,441 INFO train.py line 211 2367327] iter: 10, total_loss: 0.4102541208267212, loss_1: 0.416748046875, loss_2: 0.416748046875, loss_3: 0.235595703125
[2025-01-06 23:29:13,301 INFO train.py line 211 2367327] iter: 20, total_loss: 0.3306613564491272, loss_1: 0.419921875, loss_2: 0.40576171875, loss_3: 0.14794921875
[2025-01-06 23:29:15,175 INFO train.py line 211 2367327] iter: 30, total_loss: 0.26121166348457336, loss_1: 0.386474609375, loss_2: 0.339111328125, loss_3: 0.058837890625
[2025-01-06 23:29:17,041 INFO train.py line 211 2367327] iter: 40, total_loss: 0.20110251009464264, loss_1: 0.313232421875, loss_2: 0.268310546875, loss_3: 0.03759765625
[2025-01-06 23:29:18,917 INFO train.py line 211 2367327] iter: 50, total_loss: 0.15554197132587433, loss_1: 0.26220703125, loss_2: 0.21923828125, loss_3: 0.030303955078125
[2025-01-06 23:29:20,759 INFO train.py line 211 2367327] iter: 60, total_loss: 0.24772197008132935, loss_1: 0.32763671875, loss_2: 0.3271484375, loss_3: 0.0165863037109375
[2025-01-06 23:29:22,625 INFO train.py line 211 2367327] iter: 70, total_loss: 0.1110207587480545, loss_1: 0.1903076171875, loss_2: 0.1251220703125, loss_3: 0.02386474609375
[2025-01-06 23:29:24,516 INFO train.py line 211 2367327] iter: 80, total_loss: 0.09860920906066895, loss_1: 0.1602783203125, loss_2: 0.1092529296875, loss_3: 0.024017333984375
[2025-01-06 23:29:26,349 INFO train.py line 211 2367327] iter: 90, total_loss: 0.10670004040002823, loss_1: 0.165771484375, loss_2: 0.1397705078125, loss_3: 0.022979736328125
[2025-01-06 23:29:28,220 INFO train.py line 211 2367327] iter: 100, total_loss: 0.14450211822986603, loss_1: 0.2235107421875, loss_2: 0.201171875, loss_3: 0.01209259033203125
[2025-01-06 23:29:30,068 INFO train.py line 211 2367327] iter: 110, total_loss: 0.09260106086730957, loss_1: 0.155029296875, loss_2: 0.1365966796875, loss_3: 0.019683837890625
[2025-01-06 23:29:31,911 INFO train.py line 211 2367327] iter: 120, total_loss: 0.0819961205124855, loss_1: 0.10955810546875, loss_2: 0.0958251953125, loss_3: 0.032745361328125
[2025-01-06 23:29:33,780 INFO train.py line 211 2367327] iter: 130, total_loss: 0.10323868691921234, loss_1: 0.1483154296875, loss_2: 0.135498046875, loss_3: 0.011322021484375
[2025-01-06 23:29:35,653 INFO train.py line 211 2367327] iter: 140, total_loss: 0.07765963673591614, loss_1: 0.11334228515625, loss_2: 0.08349609375, loss_3: 0.033233642578125
[2025-01-06 23:29:37,532 INFO train.py line 211 2367327] iter: 150, total_loss: 0.08368478715419769, loss_1: 0.1942138671875, loss_2: 0.07958984375, loss_3: 0.01873779296875
[2025-01-06 23:29:39,407 INFO train.py line 211 2367327] iter: 160, total_loss: 0.07116106152534485, loss_1: 0.0968017578125, loss_2: 0.07684326171875, loss_3: 0.02825927734375
[2025-01-06 23:29:41,300 INFO train.py line 211 2367327] iter: 170, total_loss: 0.14151422679424286, loss_1: 0.227783203125, loss_2: 0.1378173828125, loss_3: 0.005542755126953125
[2025-01-06 23:29:43,163 INFO train.py line 211 2367327] iter: 180, total_loss: 0.06467179208993912, loss_1: 0.1099853515625, loss_2: 0.06500244140625, loss_3: 0.016693115234375
[2025-01-06 23:29:45,027 INFO train.py line 211 2367327] iter: 190, total_loss: 0.0637718215584755, loss_1: 0.10064697265625, loss_2: 0.073486328125, loss_3: 0.02349853515625
[2025-01-06 23:29:46,895 INFO train.py line 211 2367327] iter: 200, total_loss: 0.13613887131214142, loss_1: 0.189697265625, loss_2: 0.1827392578125, loss_3: 0.01247406005859375
[2025-01-06 23:29:48,785 INFO train.py line 211 2367327] iter: 210, total_loss: 0.06695768237113953, loss_1: 0.08154296875, loss_2: 0.065185546875, loss_3: 0.03179931640625
[2025-01-06 23:29:50,645 INFO train.py line 211 2367327] iter: 220, total_loss: 0.05434957146644592, loss_1: 0.0753173828125, loss_2: 0.05804443359375, loss_3: 0.0235443115234375
[2025-01-06 23:29:52,511 INFO train.py line 211 2367327] iter: 230, total_loss: 0.05827204883098602, loss_1: 0.06427001953125, loss_2: 0.0537109375, loss_3: 0.0289154052734375
[2025-01-06 23:29:54,430 INFO train.py line 211 2367327] iter: 240, total_loss: 0.057820066809654236, loss_1: 0.083740234375, loss_2: 0.059661865234375, loss_3: 0.0242767333984375
[2025-01-06 23:29:56,302 INFO train.py line 211 2367327] iter: 250, total_loss: 0.09660057723522186, loss_1: 0.1834716796875, loss_2: 0.09954833984375, loss_3: 0.006145477294921875
[2025-01-06 23:29:58,198 INFO train.py line 211 2367327] iter: 260, total_loss: 0.08761166036128998, loss_1: 0.1107177734375, loss_2: 0.09765625, loss_3: 0.010406494140625
[2025-01-06 23:30:00,028 INFO train.py line 211 2367327] iter: 270, total_loss: 0.06003821641206741, loss_1: 0.07635498046875, loss_2: 0.07373046875, loss_3: 0.02142333984375
[2025-01-06 23:30:01,881 INFO train.py line 211 2367327] iter: 280, total_loss: 0.05668601393699646, loss_1: 0.0802001953125, loss_2: 0.045166015625, loss_3: 0.0235748291015625
[2025-01-06 23:30:03,786 INFO train.py line 211 2367327] iter: 290, total_loss: 0.06726633012294769, loss_1: 0.11187744140625, loss_2: 0.0843505859375, loss_3: 0.00797271728515625
[2025-01-06 23:30:05,654 INFO train.py line 211 2367327] iter: 300, total_loss: 0.05216808244585991, loss_1: 0.0814208984375, loss_2: 0.07073974609375, loss_3: 0.0190887451171875
[2025-01-06 23:30:07,508 INFO train.py line 211 2367327] iter: 310, total_loss: 0.05233638733625412, loss_1: 0.074951171875, loss_2: 0.05340576171875, loss_3: 0.018402099609375
[2025-01-06 23:30:09,383 INFO train.py line 211 2367327] iter: 320, total_loss: 0.05494941771030426, loss_1: 0.088134765625, loss_2: 0.066162109375, loss_3: 0.01453399658203125
[2025-01-06 23:30:11,236 INFO train.py line 211 2367327] iter: 330, total_loss: 0.051217008382081985, loss_1: 0.07940673828125, loss_2: 0.066650390625, loss_3: 0.014801025390625
[2025-01-06 23:30:13,099 INFO train.py line 211 2367327] iter: 340, total_loss: 0.0573953241109848, loss_1: 0.07305908203125, loss_2: 0.04901123046875, loss_3: 0.02752685546875
[2025-01-06 23:30:14,979 INFO train.py line 211 2367327] iter: 350, total_loss: 0.07893019914627075, loss_1: 0.1124267578125, loss_2: 0.10760498046875, loss_3: 0.00811767578125
[2025-01-06 23:30:16,860 INFO train.py line 211 2367327] iter: 360, total_loss: 0.05623682960867882, loss_1: 0.110595703125, loss_2: 0.043731689453125, loss_3: 0.017547607421875
[2025-01-06 23:30:18,695 INFO train.py line 211 2367327] iter: 370, total_loss: 0.05997532606124878, loss_1: 0.10479736328125, loss_2: 0.0615234375, loss_3: 0.0168304443359375
[2025-01-06 23:30:20,579 INFO train.py line 211 2367327] iter: 380, total_loss: 0.05488390102982521, loss_1: 0.0743408203125, loss_2: 0.0743408203125, loss_3: 0.018280029296875
[2025-01-06 23:30:22,445 INFO train.py line 211 2367327] iter: 390, total_loss: 0.04660223424434662, loss_1: 0.06097412109375, loss_2: 0.040008544921875, loss_3: 0.0226898193359375
[2025-01-06 23:30:24,336 INFO train.py line 211 2367327] iter: 400, total_loss: 0.07791776955127716, loss_1: 0.11712646484375, loss_2: 0.08148193359375, loss_3: 0.007617950439453125
[2025-01-06 23:30:26,197 INFO train.py line 211 2367327] iter: 410, total_loss: 0.06579650193452835, loss_1: 0.0919189453125, loss_2: 0.08087158203125, loss_3: 0.029296875
[2025-01-06 23:30:28,048 INFO train.py line 211 2367327] iter: 420, total_loss: 0.048891011625528336, loss_1: 0.07281494140625, loss_2: 0.044281005859375, loss_3: 0.01922607421875
[2025-01-06 23:30:29,945 INFO train.py line 211 2367327] iter: 430, total_loss: 0.04791576415300369, loss_1: 0.07086181640625, loss_2: 0.043914794921875, loss_3: 0.023468017578125
[2025-01-06 23:30:31,867 INFO train.py line 211 2367327] iter: 440, total_loss: 0.07226461917161942, loss_1: 0.11688232421875, loss_2: 0.07391357421875, loss_3: 0.00585174560546875
[2025-01-06 23:30:33,758 INFO train.py line 211 2367327] iter: 450, total_loss: 0.05932282656431198, loss_1: 0.08734130859375, loss_2: 0.06561279296875, loss_3: 0.006999969482421875
[2025-01-06 23:30:35,620 INFO train.py line 211 2367327] iter: 460, total_loss: 0.06575698405504227, loss_1: 0.11322021484375, loss_2: 0.064453125, loss_3: 0.0201263427734375
[2025-01-06 23:30:37,507 INFO train.py line 211 2367327] iter: 470, total_loss: 0.07267339527606964, loss_1: 0.09344482421875, loss_2: 0.07269287109375, loss_3: 0.038421630859375
[2025-01-06 23:30:39,392 INFO train.py line 211 2367327] iter: 480, total_loss: 0.0754430815577507, loss_1: 0.1033935546875, loss_2: 0.08819580078125, loss_3: 0.026275634765625
[2025-01-06 23:30:41,234 INFO train.py line 211 2367327] iter: 490, total_loss: 0.0470573827624321, loss_1: 0.08453369140625, loss_2: 0.042388916015625, loss_3: 0.0158233642578125
[2025-01-06 23:30:42,908 INFO train.py line 248 2367327] => Loading checkpoint & weight ...
[2025-01-06 23:30:42,908 INFO train.py line 257 2367327] No weight found at: None
[2025-01-06 23:30:43,347 INFO train.py line 324 2367327] scale_0.0 has 32 groups
[2025-01-06 23:30:43,738 INFO train.py line 324 2367327] scale_0.5 has 30 groups
[2025-01-06 23:30:44,137 INFO train.py line 324 2367327] scale_1.0 has 25 groups
[2025-01-06 23:30:44,544 INFO train.py line 324 2367327] scale_1.5 has 16 groups
[2025-01-06 23:30:44,952 INFO train.py line 324 2367327] scale_2.0 has 5 groups
[2025-01-06 23:32:30,066 INFO train.py line 133 2372483] => Loading config ...
[2025-01-06 23:32:30,066 INFO train.py line 135 2372483] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:32:30,370 INFO train.py line 136 2372483] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 32280932
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:32:30,370 INFO train.py line 137 2372483] => Building model ...
[2025-01-06 23:32:30,935 INFO train.py line 425 2372483] Num params: 1634304
[2025-01-06 23:32:31,007 INFO train.py line 139 2372483] => Building writer ...
[2025-01-06 23:32:31,018 INFO train.py line 435 2372483] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:32:31,018 INFO train.py line 141 2372483] => Building train dataset & dataloader ...
[2025-01-06 23:33:11,847 INFO dataset_render_16views.py line 145 2372483] Processing frame_0
[2025-01-06 23:33:14,476 INFO dataset_render_16views.py line 145 2372483] Processing frame_1
[2025-01-06 23:33:16,902 INFO dataset_render_16views.py line 145 2372483] Processing frame_2
[2025-01-06 23:33:19,240 INFO dataset_render_16views.py line 145 2372483] Processing frame_3
[2025-01-06 23:33:21,619 INFO dataset_render_16views.py line 145 2372483] Processing frame_4
[2025-01-06 23:33:23,971 INFO dataset_render_16views.py line 145 2372483] Processing frame_5
[2025-01-06 23:33:26,213 INFO dataset_render_16views.py line 145 2372483] Processing frame_6
[2025-01-06 23:33:28,351 INFO dataset_render_16views.py line 145 2372483] Processing frame_7
[2025-01-06 23:33:30,681 INFO dataset_render_16views.py line 145 2372483] Processing frame_8
[2025-01-06 23:33:33,223 INFO dataset_render_16views.py line 145 2372483] Processing frame_9
[2025-01-06 23:33:35,548 INFO dataset_render_16views.py line 145 2372483] Processing frame_10
[2025-01-06 23:33:37,863 INFO dataset_render_16views.py line 145 2372483] Processing frame_11
[2025-01-06 23:33:40,124 INFO dataset_render_16views.py line 145 2372483] Processing frame_12
[2025-01-06 23:33:42,574 INFO dataset_render_16views.py line 145 2372483] Processing frame_13
[2025-01-06 23:33:44,854 INFO dataset_render_16views.py line 145 2372483] Processing frame_14
[2025-01-06 23:33:47,155 INFO dataset_render_16views.py line 145 2372483] Processing frame_15
[2025-01-06 23:33:49,476 INFO dataset_render_16views.py line 69 2372483] Totally 16 x 1 samples in train set.
[2025-01-06 23:33:49,476 INFO train.py line 145 2372483] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:33:49,478 INFO optimizer.py line 64 2372483] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:33:49,478 INFO train.py line 149 2372483] => Building hooks ...
[2025-01-06 23:33:49,480 INFO train.py line 166 2372483] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 23:33:49,480 INFO train.py line 171 2372483] => Loading checkpoint & weight ...
[2025-01-06 23:33:49,645 INFO train.py line 192 2372483] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 23:33:50,155 INFO train.py line 211 2372483] iter: 0, total_loss: 0.4372270703315735, loss_1: 0.3984375, loss_2: 0.39697265625, loss_3: 0.3095703125
[2025-01-06 23:33:52,046 INFO train.py line 211 2372483] iter: 10, total_loss: 0.49762266874313354, loss_1: 0.372802734375, loss_2: 0.416015625, loss_3: 0.37060546875
[2025-01-06 23:33:53,973 INFO train.py line 211 2372483] iter: 20, total_loss: 0.31748801469802856, loss_1: 0.41064453125, loss_2: 0.396484375, loss_3: 0.12371826171875
[2025-01-06 23:33:55,863 INFO train.py line 211 2372483] iter: 30, total_loss: 0.2838631868362427, loss_1: 0.38720703125, loss_2: 0.3818359375, loss_3: 0.0577392578125
[2025-01-06 23:33:57,759 INFO train.py line 211 2372483] iter: 40, total_loss: 0.19207054376602173, loss_1: 0.26708984375, loss_2: 0.2271728515625, loss_3: 0.056793212890625
[2025-01-06 23:33:59,673 INFO train.py line 211 2372483] iter: 50, total_loss: 0.15380850434303284, loss_1: 0.259521484375, loss_2: 0.210205078125, loss_3: 0.030609130859375
[2025-01-06 23:34:01,591 INFO train.py line 211 2372483] iter: 60, total_loss: 0.1532537043094635, loss_1: 0.19482421875, loss_2: 0.189697265625, loss_3: 0.03472900390625
[2025-01-06 23:34:03,466 INFO train.py line 211 2372483] iter: 70, total_loss: 0.11733108758926392, loss_1: 0.185791015625, loss_2: 0.161865234375, loss_3: 0.0318603515625
[2025-01-06 23:34:05,359 INFO train.py line 211 2372483] iter: 80, total_loss: 0.0987221971154213, loss_1: 0.1466064453125, loss_2: 0.12445068359375, loss_3: 0.028778076171875
[2025-01-06 23:34:07,301 INFO train.py line 211 2372483] iter: 90, total_loss: 0.09625839442014694, loss_1: 0.13427734375, loss_2: 0.12066650390625, loss_3: 0.0300445556640625
[2025-01-06 23:34:09,260 INFO train.py line 211 2372483] iter: 100, total_loss: 0.11371076107025146, loss_1: 0.153076171875, loss_2: 0.12548828125, loss_3: 0.0273284912109375
[2025-01-06 23:34:11,194 INFO train.py line 211 2372483] iter: 110, total_loss: 0.08365470170974731, loss_1: 0.11517333984375, loss_2: 0.104248046875, loss_3: 0.034271240234375
[2025-01-06 23:34:13,126 INFO train.py line 211 2372483] iter: 120, total_loss: 0.07821199297904968, loss_1: 0.11279296875, loss_2: 0.0703125, loss_3: 0.03070068359375
[2025-01-06 23:34:15,048 INFO train.py line 211 2372483] iter: 130, total_loss: 0.08000277727842331, loss_1: 0.1639404296875, loss_2: 0.0673828125, loss_3: 0.0164947509765625
[2025-01-06 23:34:16,942 INFO train.py line 211 2372483] iter: 140, total_loss: 0.06228550150990486, loss_1: 0.09375, loss_2: 0.0877685546875, loss_3: 0.0231475830078125
[2025-01-06 23:34:18,817 INFO train.py line 211 2372483] iter: 150, total_loss: 0.06413530558347702, loss_1: 0.08056640625, loss_2: 0.0662841796875, loss_3: 0.0298919677734375
[2025-01-06 23:34:20,719 INFO train.py line 211 2372483] iter: 160, total_loss: 0.06767255067825317, loss_1: 0.069580078125, loss_2: 0.0574951171875, loss_3: 0.043212890625
[2025-01-06 23:34:22,615 INFO train.py line 211 2372483] iter: 170, total_loss: 0.10716380178928375, loss_1: 0.190185546875, loss_2: 0.1163330078125, loss_3: 0.006168365478515625
[2025-01-06 23:34:24,520 INFO train.py line 211 2372483] iter: 180, total_loss: 0.06384313106536865, loss_1: 0.07525634765625, loss_2: 0.061553955078125, loss_3: 0.036773681640625
[2025-01-06 23:34:26,409 INFO train.py line 211 2372483] iter: 190, total_loss: 0.05573665350675583, loss_1: 0.0819091796875, loss_2: 0.07513427734375, loss_3: 0.0177001953125
[2025-01-06 23:34:28,310 INFO train.py line 211 2372483] iter: 200, total_loss: 0.06334641575813293, loss_1: 0.10052490234375, loss_2: 0.05279541015625, loss_3: 0.0250091552734375
[2025-01-06 23:34:30,167 INFO train.py line 211 2372483] iter: 210, total_loss: 0.055590417236089706, loss_1: 0.09552001953125, loss_2: 0.049560546875, loss_3: 0.021636962890625
[2025-01-06 23:34:32,037 INFO train.py line 211 2372483] iter: 220, total_loss: 0.05579938367009163, loss_1: 0.0767822265625, loss_2: 0.061737060546875, loss_3: 0.0211029052734375
[2025-01-06 23:34:33,911 INFO train.py line 211 2372483] iter: 230, total_loss: 0.052581533789634705, loss_1: 0.075439453125, loss_2: 0.0697021484375, loss_3: 0.017425537109375
[2025-01-06 23:34:35,841 INFO train.py line 211 2372483] iter: 240, total_loss: 0.062052298337221146, loss_1: 0.07745361328125, loss_2: 0.06494140625, loss_3: 0.0230255126953125
[2025-01-06 23:34:37,720 INFO train.py line 211 2372483] iter: 250, total_loss: 0.061737820506095886, loss_1: 0.08270263671875, loss_2: 0.08062744140625, loss_3: 0.020355224609375
[2025-01-06 23:34:39,567 INFO train.py line 211 2372483] iter: 260, total_loss: 0.09851998090744019, loss_1: 0.1453857421875, loss_2: 0.08392333984375, loss_3: 0.0355224609375
[2025-01-06 23:34:41,434 INFO train.py line 211 2372483] iter: 270, total_loss: 0.058636389672756195, loss_1: 0.089111328125, loss_2: 0.064453125, loss_3: 0.0205230712890625
[2025-01-06 23:34:43,335 INFO train.py line 211 2372483] iter: 280, total_loss: 0.04808727651834488, loss_1: 0.06951904296875, loss_2: 0.051239013671875, loss_3: 0.0196685791015625
[2025-01-06 23:34:45,203 INFO train.py line 211 2372483] iter: 290, total_loss: 0.053833454847335815, loss_1: 0.08734130859375, loss_2: 0.055908203125, loss_3: 0.01238250732421875
[2025-01-06 23:34:47,093 INFO train.py line 211 2372483] iter: 300, total_loss: 0.047898657619953156, loss_1: 0.056610107421875, loss_2: 0.04229736328125, loss_3: 0.0236968994140625
[2025-01-06 23:34:48,981 INFO train.py line 211 2372483] iter: 310, total_loss: 0.044621098786592484, loss_1: 0.053802490234375, loss_2: 0.044891357421875, loss_3: 0.02294921875
[2025-01-06 23:34:50,848 INFO train.py line 211 2372483] iter: 320, total_loss: 0.04587610810995102, loss_1: 0.0670166015625, loss_2: 0.0391845703125, loss_3: 0.0221405029296875
[2025-01-06 23:34:52,731 INFO train.py line 211 2372483] iter: 330, total_loss: 0.05723637342453003, loss_1: 0.0662841796875, loss_2: 0.054718017578125, loss_3: 0.0284423828125
[2025-01-06 23:34:54,631 INFO train.py line 211 2372483] iter: 340, total_loss: 0.04082653671503067, loss_1: 0.05340576171875, loss_2: 0.0391845703125, loss_3: 0.0224151611328125
[2025-01-06 23:34:56,525 INFO train.py line 211 2372483] iter: 350, total_loss: 0.06245311349630356, loss_1: 0.0780029296875, loss_2: 0.07080078125, loss_3: 0.019439697265625
[2025-01-06 23:34:58,396 INFO train.py line 211 2372483] iter: 360, total_loss: 0.07086844742298126, loss_1: 0.1494140625, loss_2: 0.0413818359375, loss_3: 0.022857666015625
[2025-01-06 23:35:00,289 INFO train.py line 211 2372483] iter: 370, total_loss: 0.042251329869031906, loss_1: 0.061798095703125, loss_2: 0.039794921875, loss_3: 0.0187225341796875
[2025-01-06 23:35:02,177 INFO train.py line 211 2372483] iter: 380, total_loss: 0.06519503891468048, loss_1: 0.09197998046875, loss_2: 0.08868408203125, loss_3: 0.01366424560546875
[2025-01-06 23:35:04,039 INFO train.py line 211 2372483] iter: 390, total_loss: 0.07169801741838455, loss_1: 0.13525390625, loss_2: 0.0703125, loss_3: 0.02105712890625
[2025-01-06 23:35:05,936 INFO train.py line 211 2372483] iter: 400, total_loss: 0.1305103749036789, loss_1: 0.216064453125, loss_2: 0.13720703125, loss_3: 0.00514984130859375
[2025-01-06 23:35:07,836 INFO train.py line 211 2372483] iter: 410, total_loss: 0.056853145360946655, loss_1: 0.061126708984375, loss_2: 0.04473876953125, loss_3: 0.03594970703125
[2025-01-06 23:35:09,702 INFO train.py line 211 2372483] iter: 420, total_loss: 0.054141558706760406, loss_1: 0.07232666015625, loss_2: 0.0616455078125, loss_3: 0.022430419921875
[2025-01-06 23:35:11,588 INFO train.py line 211 2372483] iter: 430, total_loss: 0.060635630041360855, loss_1: 0.08673095703125, loss_2: 0.079345703125, loss_3: 0.02142333984375
[2025-01-06 23:35:13,479 INFO train.py line 211 2372483] iter: 440, total_loss: 0.06944306194782257, loss_1: 0.08404541015625, loss_2: 0.0770263671875, loss_3: 0.02642822265625
[2025-01-06 23:35:15,368 INFO train.py line 211 2372483] iter: 450, total_loss: 0.04793451726436615, loss_1: 0.070068359375, loss_2: 0.037750244140625, loss_3: 0.0259552001953125
[2025-01-06 23:35:17,239 INFO train.py line 211 2372483] iter: 460, total_loss: 0.045139335095882416, loss_1: 0.044525146484375, loss_2: 0.03509521484375, loss_3: 0.03204345703125
[2025-01-06 23:35:19,096 INFO train.py line 211 2372483] iter: 470, total_loss: 0.043859850615262985, loss_1: 0.06463623046875, loss_2: 0.033721923828125, loss_3: 0.0215301513671875
[2025-01-06 23:35:20,984 INFO train.py line 211 2372483] iter: 480, total_loss: 0.05226193368434906, loss_1: 0.07354736328125, loss_2: 0.03424072265625, loss_3: 0.027191162109375
[2025-01-06 23:35:22,902 INFO train.py line 211 2372483] iter: 490, total_loss: 0.056796181946992874, loss_1: 0.08209228515625, loss_2: 0.07269287109375, loss_3: 0.0157928466796875
[2025-01-06 23:35:24,628 INFO train.py line 248 2372483] => Loading checkpoint & weight ...
[2025-01-06 23:35:24,628 INFO train.py line 257 2372483] No weight found at: None
[2025-01-06 23:35:25,057 INFO train.py line 324 2372483] scale_0.0 has 32 groups
[2025-01-06 23:35:25,462 INFO train.py line 324 2372483] scale_0.5 has 29 groups
[2025-01-06 23:35:25,864 INFO train.py line 324 2372483] scale_1.0 has 27 groups
[2025-01-06 23:35:26,273 INFO train.py line 324 2372483] scale_1.5 has 19 groups
[2025-01-06 23:35:26,685 INFO train.py line 324 2372483] scale_2.0 has 4 groups
[2025-01-06 23:42:08,484 INFO train.py line 133 2382469] => Loading config ...
[2025-01-06 23:42:08,484 INFO train.py line 135 2382469] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:42:08,785 INFO train.py line 136 2382469] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 10703939
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:42:08,785 INFO train.py line 137 2382469] => Building model ...
[2025-01-06 23:42:09,351 INFO train.py line 425 2382469] Num params: 1634304
[2025-01-06 23:42:09,423 INFO train.py line 139 2382469] => Building writer ...
[2025-01-06 23:42:09,433 INFO train.py line 435 2382469] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:42:09,433 INFO train.py line 141 2382469] => Building train dataset & dataloader ...
[2025-01-06 23:42:50,272 INFO dataset_render_16views.py line 145 2382469] Processing frame_0
[2025-01-06 23:42:52,932 INFO dataset_render_16views.py line 145 2382469] Processing frame_1
[2025-01-06 23:42:55,441 INFO dataset_render_16views.py line 145 2382469] Processing frame_2
[2025-01-06 23:42:57,802 INFO dataset_render_16views.py line 145 2382469] Processing frame_3
[2025-01-06 23:43:00,121 INFO dataset_render_16views.py line 145 2382469] Processing frame_4
[2025-01-06 23:43:02,562 INFO dataset_render_16views.py line 145 2382469] Processing frame_5
[2025-01-06 23:43:04,815 INFO dataset_render_16views.py line 145 2382469] Processing frame_6
[2025-01-06 23:43:07,025 INFO dataset_render_16views.py line 145 2382469] Processing frame_7
[2025-01-06 23:43:09,384 INFO dataset_render_16views.py line 145 2382469] Processing frame_8
[2025-01-06 23:43:11,926 INFO dataset_render_16views.py line 145 2382469] Processing frame_9
[2025-01-06 23:43:14,267 INFO dataset_render_16views.py line 145 2382469] Processing frame_10
[2025-01-06 23:43:16,587 INFO dataset_render_16views.py line 145 2382469] Processing frame_11
[2025-01-06 23:43:18,842 INFO dataset_render_16views.py line 145 2382469] Processing frame_12
[2025-01-06 23:43:21,310 INFO dataset_render_16views.py line 145 2382469] Processing frame_13
[2025-01-06 23:43:23,518 INFO dataset_render_16views.py line 145 2382469] Processing frame_14
[2025-01-06 23:43:25,804 INFO dataset_render_16views.py line 145 2382469] Processing frame_15
[2025-01-06 23:43:28,118 INFO dataset_render_16views.py line 69 2382469] Totally 16 x 1 samples in train set.
[2025-01-06 23:43:28,118 INFO train.py line 145 2382469] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:43:28,120 INFO optimizer.py line 64 2382469] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:43:28,120 INFO train.py line 149 2382469] => Building hooks ...
[2025-01-06 23:43:28,122 INFO train.py line 166 2382469] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 23:43:28,122 INFO train.py line 171 2382469] => Loading checkpoint & weight ...
[2025-01-06 23:43:28,261 INFO train.py line 192 2382469] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 23:43:28,760 INFO train.py line 211 2382469] iter: 0, total_loss: 0.4420197010040283, loss_1: 0.414794921875, loss_2: 0.414306640625, loss_3: 0.293212890625
[2025-01-06 23:43:30,638 INFO train.py line 211 2382469] iter: 10, total_loss: 0.40513601899147034, loss_1: 0.419921875, loss_2: 0.4052734375, loss_3: 0.2392578125
[2025-01-06 23:43:32,552 INFO train.py line 211 2382469] iter: 20, total_loss: 0.3819562792778015, loss_1: 0.509765625, loss_2: 0.45458984375, loss_3: 0.1051025390625
[2025-01-06 23:43:34,443 INFO train.py line 211 2382469] iter: 30, total_loss: 0.24898302555084229, loss_1: 0.354736328125, loss_2: 0.333984375, loss_3: 0.060272216796875
[2025-01-06 23:43:36,327 INFO train.py line 211 2382469] iter: 40, total_loss: 0.19265474379062653, loss_1: 0.280029296875, loss_2: 0.272216796875, loss_3: 0.042205810546875
[2025-01-06 23:43:38,198 INFO train.py line 211 2382469] iter: 50, total_loss: 0.16160832345485687, loss_1: 0.221923828125, loss_2: 0.207763671875, loss_3: 0.042327880859375
[2025-01-06 23:43:40,124 INFO train.py line 211 2382469] iter: 60, total_loss: 0.12050103396177292, loss_1: 0.2188720703125, loss_2: 0.1566162109375, loss_3: 0.0205230712890625
[2025-01-06 23:43:41,999 INFO train.py line 211 2382469] iter: 70, total_loss: 0.1133430004119873, loss_1: 0.16552734375, loss_2: 0.14111328125, loss_3: 0.0364990234375
[2025-01-06 23:43:43,888 INFO train.py line 211 2382469] iter: 80, total_loss: 0.11491870135068893, loss_1: 0.158203125, loss_2: 0.1361083984375, loss_3: 0.03607177734375
[2025-01-06 23:43:45,777 INFO train.py line 211 2382469] iter: 90, total_loss: 0.08059407025575638, loss_1: 0.11932373046875, loss_2: 0.09832763671875, loss_3: 0.028594970703125
[2025-01-06 23:43:47,684 INFO train.py line 211 2382469] iter: 100, total_loss: 0.08638247102499008, loss_1: 0.09576416015625, loss_2: 0.0823974609375, loss_3: 0.0467529296875
[2025-01-06 23:43:49,554 INFO train.py line 211 2382469] iter: 110, total_loss: 0.08666089922189713, loss_1: 0.1336669921875, loss_2: 0.09063720703125, loss_3: 0.030792236328125
[2025-01-06 23:43:51,393 INFO train.py line 211 2382469] iter: 120, total_loss: 0.08122993260622025, loss_1: 0.11859130859375, loss_2: 0.09185791015625, loss_3: 0.02105712890625
[2025-01-06 23:43:53,257 INFO train.py line 211 2382469] iter: 130, total_loss: 0.07021491974592209, loss_1: 0.09881591796875, loss_2: 0.0704345703125, loss_3: 0.0266876220703125
[2025-01-06 23:43:55,144 INFO train.py line 211 2382469] iter: 140, total_loss: 0.08748452365398407, loss_1: 0.12646484375, loss_2: 0.1138916015625, loss_3: 0.031646728515625
[2025-01-06 23:43:57,041 INFO train.py line 211 2382469] iter: 150, total_loss: 0.10573936253786087, loss_1: 0.18017578125, loss_2: 0.1356201171875, loss_3: 0.0187530517578125
[2025-01-06 23:43:58,930 INFO train.py line 211 2382469] iter: 160, total_loss: 0.07834431529045105, loss_1: 0.1094970703125, loss_2: 0.093505859375, loss_3: 0.0211639404296875
[2025-01-06 23:44:00,804 INFO train.py line 211 2382469] iter: 170, total_loss: 0.06741894036531448, loss_1: 0.09954833984375, loss_2: 0.06329345703125, loss_3: 0.0234222412109375
[2025-01-06 23:44:02,701 INFO train.py line 211 2382469] iter: 180, total_loss: 0.07582254707813263, loss_1: 0.09423828125, loss_2: 0.07928466796875, loss_3: 0.026123046875
[2025-01-06 23:44:04,610 INFO train.py line 211 2382469] iter: 190, total_loss: 0.07467332482337952, loss_1: 0.0894775390625, loss_2: 0.074951171875, loss_3: 0.037689208984375
[2025-01-06 23:44:06,505 INFO train.py line 211 2382469] iter: 200, total_loss: 0.06913833320140839, loss_1: 0.07879638671875, loss_2: 0.0728759765625, loss_3: 0.0308380126953125
[2025-01-06 23:44:08,382 INFO train.py line 211 2382469] iter: 210, total_loss: 0.061489298939704895, loss_1: 0.1387939453125, loss_2: 0.0657958984375, loss_3: 0.01358795166015625
[2025-01-06 23:44:10,253 INFO train.py line 211 2382469] iter: 220, total_loss: 0.0710507482290268, loss_1: 0.0936279296875, loss_2: 0.0887451171875, loss_3: 0.0195465087890625
[2025-01-06 23:44:12,133 INFO train.py line 211 2382469] iter: 230, total_loss: 0.055061712861061096, loss_1: 0.055511474609375, loss_2: 0.04376220703125, loss_3: 0.037017822265625
[2025-01-06 23:44:14,014 INFO train.py line 211 2382469] iter: 240, total_loss: 0.05934113636612892, loss_1: 0.11322021484375, loss_2: 0.041900634765625, loss_3: 0.019500732421875
[2025-01-06 23:44:15,903 INFO train.py line 211 2382469] iter: 250, total_loss: 0.08900241553783417, loss_1: 0.1329345703125, loss_2: 0.10760498046875, loss_3: 0.0059356689453125
[2025-01-06 23:44:17,775 INFO train.py line 211 2382469] iter: 260, total_loss: 0.06103935092687607, loss_1: 0.0889892578125, loss_2: 0.07275390625, loss_3: 0.023101806640625
[2025-01-06 23:44:19,639 INFO train.py line 211 2382469] iter: 270, total_loss: 0.06749650835990906, loss_1: 0.1180419921875, loss_2: 0.0860595703125, loss_3: 0.0174407958984375
[2025-01-06 23:44:21,525 INFO train.py line 211 2382469] iter: 280, total_loss: 0.05838499218225479, loss_1: 0.06365966796875, loss_2: 0.040069580078125, loss_3: 0.0380859375
[2025-01-06 23:44:23,430 INFO train.py line 211 2382469] iter: 290, total_loss: 0.05991078168153763, loss_1: 0.08966064453125, loss_2: 0.045318603515625, loss_3: 0.0294189453125
[2025-01-06 23:44:25,320 INFO train.py line 211 2382469] iter: 300, total_loss: 0.052088700234889984, loss_1: 0.06292724609375, loss_2: 0.042755126953125, loss_3: 0.032440185546875
[2025-01-06 23:44:27,203 INFO train.py line 211 2382469] iter: 310, total_loss: 0.06927303969860077, loss_1: 0.12384033203125, loss_2: 0.061767578125, loss_3: 0.020111083984375
[2025-01-06 23:44:29,091 INFO train.py line 211 2382469] iter: 320, total_loss: 0.061561718583106995, loss_1: 0.1094970703125, loss_2: 0.06732177734375, loss_3: 0.0185394287109375
[2025-01-06 23:44:31,001 INFO train.py line 211 2382469] iter: 330, total_loss: 0.061930879950523376, loss_1: 0.0667724609375, loss_2: 0.06536865234375, loss_3: 0.036712646484375
[2025-01-06 23:44:32,910 INFO train.py line 211 2382469] iter: 340, total_loss: 0.05821458250284195, loss_1: 0.08367919921875, loss_2: 0.07879638671875, loss_3: 0.021392822265625
[2025-01-06 23:44:34,819 INFO train.py line 211 2382469] iter: 350, total_loss: 0.05445292219519615, loss_1: 0.0965576171875, loss_2: 0.061187744140625, loss_3: 0.0130615234375
[2025-01-06 23:44:36,705 INFO train.py line 211 2382469] iter: 360, total_loss: 0.048423342406749725, loss_1: 0.0684814453125, loss_2: 0.05084228515625, loss_3: 0.021728515625
[2025-01-06 23:44:38,596 INFO train.py line 211 2382469] iter: 370, total_loss: 0.04648221284151077, loss_1: 0.0694580078125, loss_2: 0.039093017578125, loss_3: 0.0241546630859375
[2025-01-06 23:44:40,473 INFO train.py line 211 2382469] iter: 380, total_loss: 0.050460703670978546, loss_1: 0.053192138671875, loss_2: 0.048614501953125, loss_3: 0.0290374755859375
[2025-01-06 23:44:42,335 INFO train.py line 211 2382469] iter: 390, total_loss: 0.06062860041856766, loss_1: 0.10992431640625, loss_2: 0.06964111328125, loss_3: 0.0166168212890625
[2025-01-06 23:44:44,201 INFO train.py line 211 2382469] iter: 400, total_loss: 0.04965890944004059, loss_1: 0.05322265625, loss_2: 0.043975830078125, loss_3: 0.0321044921875
[2025-01-06 23:44:46,116 INFO train.py line 211 2382469] iter: 410, total_loss: 0.05692565068602562, loss_1: 0.0767822265625, loss_2: 0.044952392578125, loss_3: 0.025115966796875
[2025-01-06 23:44:48,037 INFO train.py line 211 2382469] iter: 420, total_loss: 0.06787832081317902, loss_1: 0.09912109375, loss_2: 0.08306884765625, loss_3: 0.0172119140625
[2025-01-06 23:44:49,899 INFO train.py line 211 2382469] iter: 430, total_loss: 0.047380007803440094, loss_1: 0.06866455078125, loss_2: 0.042755126953125, loss_3: 0.018798828125
[2025-01-06 23:44:51,781 INFO train.py line 211 2382469] iter: 440, total_loss: 0.06041809916496277, loss_1: 0.0830078125, loss_2: 0.081298828125, loss_3: 0.0182342529296875
[2025-01-06 23:44:53,616 INFO train.py line 211 2382469] iter: 450, total_loss: 0.05154884606599808, loss_1: 0.07861328125, loss_2: 0.0482177734375, loss_3: 0.02001953125
[2025-01-06 23:44:55,473 INFO train.py line 211 2382469] iter: 460, total_loss: 0.06469403207302094, loss_1: 0.07940673828125, loss_2: 0.07073974609375, loss_3: 0.0244140625
[2025-01-06 23:44:57,346 INFO train.py line 211 2382469] iter: 470, total_loss: 0.054647982120513916, loss_1: 0.0826416015625, loss_2: 0.0391845703125, loss_3: 0.031036376953125
[2025-01-06 23:44:59,259 INFO train.py line 211 2382469] iter: 480, total_loss: 0.05089264363050461, loss_1: 0.07061767578125, loss_2: 0.03900146484375, loss_3: 0.024658203125
[2025-01-06 23:45:01,176 INFO train.py line 211 2382469] iter: 490, total_loss: 0.05824040621519089, loss_1: 0.056732177734375, loss_2: 0.044647216796875, loss_3: 0.0333251953125
[2025-01-06 23:45:02,875 INFO train.py line 248 2382469] => Loading checkpoint & weight ...
[2025-01-06 23:45:02,875 INFO train.py line 257 2382469] No weight found at: None
[2025-01-06 23:45:03,283 INFO train.py line 324 2382469] scale_0.0 has 33 groups
[2025-01-06 23:45:03,697 INFO train.py line 324 2382469] scale_0.5 has 29 groups
[2025-01-06 23:45:04,148 INFO train.py line 324 2382469] scale_1.0 has 28 groups
[2025-01-06 23:45:04,566 INFO train.py line 324 2382469] scale_1.5 has 19 groups
[2025-01-06 23:45:04,984 INFO train.py line 324 2382469] scale_2.0 has 4 groups
[2025-01-06 23:51:57,717 INFO train.py line 133 2391970] => Loading config ...
[2025-01-06 23:51:57,717 INFO train.py line 135 2391970] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:51:58,019 INFO train.py line 136 2391970] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 59957979
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 10
eval_epoch = 10
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:51:58,019 INFO train.py line 137 2391970] => Building model ...
[2025-01-06 23:51:58,647 INFO train.py line 425 2391970] Num params: 1634304
[2025-01-06 23:51:58,720 INFO train.py line 139 2391970] => Building writer ...
[2025-01-06 23:51:58,731 INFO train.py line 435 2391970] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:51:58,731 INFO train.py line 141 2391970] => Building train dataset & dataloader ...
[2025-01-06 23:52:39,534 INFO dataset_render_16views.py line 145 2391970] Processing frame_0
[2025-01-06 23:52:42,162 INFO dataset_render_16views.py line 145 2391970] Processing frame_1
[2025-01-06 23:52:44,669 INFO dataset_render_16views.py line 145 2391970] Processing frame_2
[2025-01-06 23:52:47,015 INFO dataset_render_16views.py line 145 2391970] Processing frame_3
[2025-01-06 23:52:49,371 INFO dataset_render_16views.py line 145 2391970] Processing frame_4
[2025-01-06 23:52:51,813 INFO dataset_render_16views.py line 145 2391970] Processing frame_5
[2025-01-06 23:52:54,134 INFO dataset_render_16views.py line 145 2391970] Processing frame_6
[2025-01-06 23:52:56,345 INFO dataset_render_16views.py line 145 2391970] Processing frame_7
[2025-01-06 23:52:58,703 INFO dataset_render_16views.py line 145 2391970] Processing frame_8
[2025-01-06 23:53:01,208 INFO dataset_render_16views.py line 145 2391970] Processing frame_9
[2025-01-06 23:53:03,495 INFO dataset_render_16views.py line 145 2391970] Processing frame_10
[2025-01-06 23:53:05,822 INFO dataset_render_16views.py line 145 2391970] Processing frame_11
[2025-01-06 23:53:08,068 INFO dataset_render_16views.py line 145 2391970] Processing frame_12
[2025-01-06 23:53:10,526 INFO dataset_render_16views.py line 145 2391970] Processing frame_13
[2025-01-06 23:53:12,771 INFO dataset_render_16views.py line 145 2391970] Processing frame_14
[2025-01-06 23:53:15,083 INFO dataset_render_16views.py line 145 2391970] Processing frame_15
[2025-01-06 23:53:17,393 INFO dataset_render_16views.py line 69 2391970] Totally 16 x 1 samples in train set.
[2025-01-06 23:53:17,393 INFO train.py line 145 2391970] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:53:17,394 INFO optimizer.py line 64 2391970] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:54:09,916 INFO train.py line 133 2394545] => Loading config ...
[2025-01-06 23:54:09,916 INFO train.py line 135 2394545] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:54:10,224 INFO train.py line 136 2394545] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 12122573
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 50
eval_epoch = 50
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-06 23:54:10,225 INFO train.py line 137 2394545] => Building model ...
[2025-01-06 23:54:10,802 INFO train.py line 425 2394545] Num params: 1634304
[2025-01-06 23:54:10,874 INFO train.py line 139 2394545] => Building writer ...
[2025-01-06 23:54:10,886 INFO train.py line 435 2394545] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-06 23:54:10,886 INFO train.py line 141 2394545] => Building train dataset & dataloader ...
[2025-01-06 23:54:51,720 INFO dataset_render_16views.py line 145 2394545] Processing frame_0
[2025-01-06 23:54:54,363 INFO dataset_render_16views.py line 145 2394545] Processing frame_1
[2025-01-06 23:54:56,856 INFO dataset_render_16views.py line 145 2394545] Processing frame_2
[2025-01-06 23:54:59,196 INFO dataset_render_16views.py line 145 2394545] Processing frame_3
[2025-01-06 23:55:01,556 INFO dataset_render_16views.py line 145 2394545] Processing frame_4
[2025-01-06 23:55:03,993 INFO dataset_render_16views.py line 145 2394545] Processing frame_5
[2025-01-06 23:55:06,315 INFO dataset_render_16views.py line 145 2394545] Processing frame_6
[2025-01-06 23:55:08,517 INFO dataset_render_16views.py line 145 2394545] Processing frame_7
[2025-01-06 23:55:10,871 INFO dataset_render_16views.py line 145 2394545] Processing frame_8
[2025-01-06 23:55:13,421 INFO dataset_render_16views.py line 145 2394545] Processing frame_9
[2025-01-06 23:55:15,770 INFO dataset_render_16views.py line 145 2394545] Processing frame_10
[2025-01-06 23:55:18,078 INFO dataset_render_16views.py line 145 2394545] Processing frame_11
[2025-01-06 23:55:20,326 INFO dataset_render_16views.py line 145 2394545] Processing frame_12
[2025-01-06 23:55:22,775 INFO dataset_render_16views.py line 145 2394545] Processing frame_13
[2025-01-06 23:55:25,068 INFO dataset_render_16views.py line 145 2394545] Processing frame_14
[2025-01-06 23:55:27,358 INFO dataset_render_16views.py line 145 2394545] Processing frame_15
[2025-01-06 23:55:29,664 INFO dataset_render_16views.py line 69 2394545] Totally 16 x 1 samples in train set.
[2025-01-06 23:55:29,664 INFO train.py line 145 2394545] => Building optimize, scheduler, scaler(amp) ...
[2025-01-06 23:55:29,666 INFO optimizer.py line 64 2394545] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-06 23:55:29,666 INFO train.py line 149 2394545] => Building hooks ...
[2025-01-06 23:55:29,668 INFO train.py line 166 2394545] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-06 23:55:29,668 INFO train.py line 171 2394545] => Loading checkpoint & weight ...
[2025-01-06 23:55:29,828 INFO train.py line 192 2394545] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-06 23:55:30,343 INFO train.py line 211 2394545] iter: 0, total_loss: 0.4644082486629486, loss_1: 0.429443359375, loss_2: 0.428955078125, loss_3: 0.265869140625
[2025-01-06 23:55:32,249 INFO train.py line 211 2394545] iter: 10, total_loss: 0.3688080608844757, loss_1: 0.4560546875, loss_2: 0.45166015625, loss_3: 0.080810546875
[2025-01-06 23:55:34,159 INFO train.py line 211 2394545] iter: 20, total_loss: 0.2247527837753296, loss_1: 0.331298828125, loss_2: 0.271728515625, loss_3: 0.0400390625
[2025-01-06 23:55:36,057 INFO train.py line 211 2394545] iter: 30, total_loss: 0.1629275530576706, loss_1: 0.2161865234375, loss_2: 0.1939697265625, loss_3: 0.0684814453125
[2025-01-06 23:55:37,970 INFO train.py line 211 2394545] iter: 40, total_loss: 0.1698625236749649, loss_1: 0.2939453125, loss_2: 0.2061767578125, loss_3: 0.01091766357421875
[2025-01-06 23:55:39,689 INFO train.py line 248 2394545] => Loading checkpoint & weight ...
[2025-01-06 23:55:39,689 INFO train.py line 257 2394545] No weight found at: None
[2025-01-06 23:55:40,098 INFO train.py line 324 2394545] scale_0.0 has 30 groups
[2025-01-06 23:55:40,484 INFO train.py line 324 2394545] scale_0.5 has 34 groups
[2025-01-06 23:55:40,868 INFO train.py line 324 2394545] scale_1.0 has 31 groups
[2025-01-06 23:55:41,255 INFO train.py line 324 2394545] scale_1.5 has 35 groups
[2025-01-06 23:55:41,651 INFO train.py line 324 2394545] scale_2.0 has 30 groups
[2025-01-07 00:00:42,437 INFO train.py line 133 2401537] => Loading config ...
[2025-01-07 00:00:42,437 INFO train.py line 135 2401537] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:00:42,744 INFO train.py line 136 2401537] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 44696493
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 50
eval_epoch = 50
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-07 00:00:42,745 INFO train.py line 137 2401537] => Building model ...
[2025-01-07 00:00:43,343 INFO train.py line 425 2401537] Num params: 1634304
[2025-01-07 00:00:43,416 INFO train.py line 139 2401537] => Building writer ...
[2025-01-07 00:00:43,427 INFO train.py line 435 2401537] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:00:43,427 INFO train.py line 141 2401537] => Building train dataset & dataloader ...
[2025-01-07 00:01:24,233 INFO dataset_render_16views.py line 145 2401537] Processing frame_0
[2025-01-07 00:01:26,895 INFO dataset_render_16views.py line 145 2401537] Processing frame_1
[2025-01-07 00:01:29,334 INFO dataset_render_16views.py line 145 2401537] Processing frame_2
[2025-01-07 00:01:31,679 INFO dataset_render_16views.py line 145 2401537] Processing frame_3
[2025-01-07 00:01:34,055 INFO dataset_render_16views.py line 145 2401537] Processing frame_4
[2025-01-07 00:01:36,506 INFO dataset_render_16views.py line 145 2401537] Processing frame_5
[2025-01-07 00:01:38,836 INFO dataset_render_16views.py line 145 2401537] Processing frame_6
[2025-01-07 00:01:40,970 INFO dataset_render_16views.py line 145 2401537] Processing frame_7
[2025-01-07 00:01:43,350 INFO dataset_render_16views.py line 145 2401537] Processing frame_8
[2025-01-07 00:01:45,894 INFO dataset_render_16views.py line 145 2401537] Processing frame_9
[2025-01-07 00:01:48,255 INFO dataset_render_16views.py line 145 2401537] Processing frame_10
[2025-01-07 00:01:50,604 INFO dataset_render_16views.py line 145 2401537] Processing frame_11
[2025-01-07 00:01:52,864 INFO dataset_render_16views.py line 145 2401537] Processing frame_12
[2025-01-07 00:01:55,330 INFO dataset_render_16views.py line 145 2401537] Processing frame_13
[2025-01-07 00:01:57,618 INFO dataset_render_16views.py line 145 2401537] Processing frame_14
[2025-01-07 00:01:59,918 INFO dataset_render_16views.py line 145 2401537] Processing frame_15
[2025-01-07 00:02:02,243 INFO dataset_render_16views.py line 69 2401537] Totally 16 x 1 samples in train set.
[2025-01-07 00:02:02,243 INFO train.py line 145 2401537] => Building optimize, scheduler, scaler(amp) ...
[2025-01-07 00:02:02,245 INFO optimizer.py line 64 2401537] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-07 00:02:02,245 INFO train.py line 149 2401537] => Building hooks ...
[2025-01-07 00:02:02,246 INFO train.py line 166 2401537] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-07 00:02:02,246 INFO train.py line 171 2401537] => Loading checkpoint & weight ...
[2025-01-07 00:02:02,412 INFO train.py line 192 2401537] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-07 00:02:02,923 INFO train.py line 211 2401537] iter: 0, total_loss: 0.4701448082923889, loss_1: 0.407470703125, loss_2: 0.405029296875, loss_3: 0.330322265625
[2025-01-07 00:02:04,845 INFO train.py line 211 2401537] iter: 10, total_loss: 0.31103911995887756, loss_1: 0.41552734375, loss_2: 0.41259765625, loss_3: 0.11065673828125
[2025-01-07 00:02:06,756 INFO train.py line 211 2401537] iter: 20, total_loss: 0.21887610852718353, loss_1: 0.321533203125, loss_2: 0.319580078125, loss_3: 0.04827880859375
[2025-01-07 00:02:08,642 INFO train.py line 211 2401537] iter: 30, total_loss: 0.1805274784564972, loss_1: 0.30029296875, loss_2: 0.280517578125, loss_3: 0.0213775634765625
[2025-01-07 00:02:10,563 INFO train.py line 211 2401537] iter: 40, total_loss: 0.16213856637477875, loss_1: 0.232421875, loss_2: 0.22265625, loss_3: 0.039398193359375
[2025-01-07 00:02:12,324 INFO train.py line 248 2401537] => Loading checkpoint & weight ...
[2025-01-07 00:02:12,324 INFO train.py line 257 2401537] No weight found at: None
[2025-01-07 00:02:12,752 INFO train.py line 324 2401537] scale_0.0 has 33 groups
[2025-01-07 00:02:13,147 INFO train.py line 324 2401537] scale_0.5 has 30 groups
[2025-01-07 00:02:13,541 INFO train.py line 324 2401537] scale_1.0 has 31 groups
[2025-01-07 00:02:13,937 INFO train.py line 324 2401537] scale_1.5 has 36 groups
[2025-01-07 00:02:14,340 INFO train.py line 324 2401537] scale_2.0 has 33 groups
[2025-01-07 00:12:51,884 INFO train.py line 133 2412043] => Loading config ...
[2025-01-07 00:12:51,884 INFO train.py line 135 2412043] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:12:52,189 INFO train.py line 136 2412043] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 54132513
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 50
eval_epoch = 50
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-07 00:12:52,189 INFO train.py line 137 2412043] => Building model ...
[2025-01-07 00:12:52,757 INFO train.py line 427 2412043] Num params: 1634304
[2025-01-07 00:12:52,831 INFO train.py line 139 2412043] => Building writer ...
[2025-01-07 00:12:52,840 INFO train.py line 437 2412043] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:12:52,840 INFO train.py line 141 2412043] => Building train dataset & dataloader ...
[2025-01-07 00:13:33,645 INFO dataset_render_16views.py line 145 2412043] Processing frame_0
[2025-01-07 00:13:36,300 INFO dataset_render_16views.py line 145 2412043] Processing frame_1
[2025-01-07 00:13:38,724 INFO dataset_render_16views.py line 145 2412043] Processing frame_2
[2025-01-07 00:13:41,077 INFO dataset_render_16views.py line 145 2412043] Processing frame_3
[2025-01-07 00:13:43,380 INFO dataset_render_16views.py line 145 2412043] Processing frame_4
[2025-01-07 00:13:45,804 INFO dataset_render_16views.py line 145 2412043] Processing frame_5
[2025-01-07 00:13:48,116 INFO dataset_render_16views.py line 145 2412043] Processing frame_6
[2025-01-07 00:13:50,318 INFO dataset_render_16views.py line 145 2412043] Processing frame_7
[2025-01-07 00:13:52,644 INFO dataset_render_16views.py line 145 2412043] Processing frame_8
[2025-01-07 00:13:55,178 INFO dataset_render_16views.py line 145 2412043] Processing frame_9
[2025-01-07 00:13:57,510 INFO dataset_render_16views.py line 145 2412043] Processing frame_10
[2025-01-07 00:13:59,838 INFO dataset_render_16views.py line 145 2412043] Processing frame_11
[2025-01-07 00:14:02,096 INFO dataset_render_16views.py line 145 2412043] Processing frame_12
[2025-01-07 00:14:04,543 INFO dataset_render_16views.py line 145 2412043] Processing frame_13
[2025-01-07 00:14:06,844 INFO dataset_render_16views.py line 145 2412043] Processing frame_14
[2025-01-07 00:14:09,107 INFO dataset_render_16views.py line 145 2412043] Processing frame_15
[2025-01-07 00:14:11,408 INFO dataset_render_16views.py line 69 2412043] Totally 16 x 1 samples in train set.
[2025-01-07 00:14:11,408 INFO train.py line 145 2412043] => Building optimize, scheduler, scaler(amp) ...
[2025-01-07 00:14:11,410 INFO optimizer.py line 64 2412043] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-07 00:14:11,411 INFO train.py line 149 2412043] => Building hooks ...
[2025-01-07 00:14:11,412 INFO train.py line 166 2412043] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-07 00:14:11,412 INFO train.py line 171 2412043] => Loading checkpoint & weight ...
[2025-01-07 00:14:11,575 INFO train.py line 192 2412043] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-07 00:14:12,062 INFO train.py line 211 2412043] iter: 0, total_loss: 0.44966399669647217, loss_1: 0.407958984375, loss_2: 0.4013671875, loss_3: 0.31884765625
[2025-01-07 00:14:13,936 INFO train.py line 211 2412043] iter: 10, total_loss: 0.3469652533531189, loss_1: 0.439208984375, loss_2: 0.43701171875, loss_3: 0.07708740234375
[2025-01-07 00:14:15,815 INFO train.py line 211 2412043] iter: 20, total_loss: 0.19769558310508728, loss_1: 0.326171875, loss_2: 0.309326171875, loss_3: 0.04046630859375
[2025-01-07 00:14:17,699 INFO train.py line 211 2412043] iter: 30, total_loss: 0.17687644064426422, loss_1: 0.28759765625, loss_2: 0.197021484375, loss_3: 0.03656005859375
[2025-01-07 00:14:19,548 INFO train.py line 211 2412043] iter: 40, total_loss: 0.14932653307914734, loss_1: 0.249755859375, loss_2: 0.1556396484375, loss_3: 0.02960205078125
[2025-01-07 00:14:21,245 INFO train.py line 248 2412043] => Loading checkpoint & weight ...
[2025-01-07 00:14:21,245 INFO train.py line 257 2412043] No weight found at: None
[2025-01-07 00:14:21,744 INFO train.py line 324 2412043] scale_0.0 has 34 groups, mesh_voting: True
[2025-01-07 00:14:21,755 INFO train.py line 359 2412043] shape of mesh_group (36457,)
[2025-01-07 00:14:22,003 INFO train.py line 367 2412043] Mesh has 36457 faces
[2025-01-07 00:14:22,135 INFO train.py line 324 2412043] scale_0.5 has 29 groups, mesh_voting: True
[2025-01-07 00:14:22,141 INFO train.py line 359 2412043] shape of mesh_group (36457,)
[2025-01-07 00:14:22,393 INFO train.py line 367 2412043] Mesh has 36457 faces
[2025-01-07 00:14:22,525 INFO train.py line 324 2412043] scale_1.0 has 30 groups, mesh_voting: True
[2025-01-07 00:14:22,530 INFO train.py line 359 2412043] shape of mesh_group (36457,)
[2025-01-07 00:14:22,785 INFO train.py line 367 2412043] Mesh has 36457 faces
[2025-01-07 00:14:22,922 INFO train.py line 324 2412043] scale_1.5 has 31 groups, mesh_voting: True
[2025-01-07 00:14:22,928 INFO train.py line 359 2412043] shape of mesh_group (36457,)
[2025-01-07 00:14:23,184 INFO train.py line 367 2412043] Mesh has 36457 faces
[2025-01-07 00:14:23,332 INFO train.py line 324 2412043] scale_2.0 has 30 groups, mesh_voting: True
[2025-01-07 00:14:23,338 INFO train.py line 359 2412043] shape of mesh_group (36457,)
[2025-01-07 00:14:23,590 INFO train.py line 367 2412043] Mesh has 36457 faces
[2025-01-07 00:19:21,349 INFO train.py line 133 2418532] => Loading config ...
[2025-01-07 00:19:21,350 INFO train.py line 135 2418532] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:19:21,655 INFO train.py line 136 2418532] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 23589464
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.5, 1.0, 1.5, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-07 00:19:21,655 INFO train.py line 137 2418532] => Building model ...
[2025-01-07 00:19:22,233 INFO train.py line 427 2418532] Num params: 1634304
[2025-01-07 00:19:22,305 INFO train.py line 139 2418532] => Building writer ...
[2025-01-07 00:19:22,316 INFO train.py line 437 2418532] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:19:22,316 INFO train.py line 141 2418532] => Building train dataset & dataloader ...
[2025-01-07 00:20:03,198 INFO dataset_render_16views.py line 145 2418532] Processing frame_0
[2025-01-07 00:20:05,835 INFO dataset_render_16views.py line 145 2418532] Processing frame_1
[2025-01-07 00:20:08,352 INFO dataset_render_16views.py line 145 2418532] Processing frame_2
[2025-01-07 00:20:10,709 INFO dataset_render_16views.py line 145 2418532] Processing frame_3
[2025-01-07 00:20:13,086 INFO dataset_render_16views.py line 145 2418532] Processing frame_4
[2025-01-07 00:20:15,517 INFO dataset_render_16views.py line 145 2418532] Processing frame_5
[2025-01-07 00:20:15,762 INFO dataset_render_16views.py line 145 2418532] Processing frame_6
[2025-01-07 00:20:16,620 INFO dataset_render_16views.py line 145 2418532] Processing frame_7
[2025-01-07 00:20:17,231 INFO dataset_render_16views.py line 145 2418532] Processing frame_8
[2025-01-07 00:20:17,353 INFO dataset_render_16views.py line 145 2418532] Processing frame_9
[2025-01-07 00:20:17,978 INFO dataset_render_16views.py line 145 2418532] Processing frame_10
[2025-01-07 00:20:50,796 INFO train.py line 133 2420243] => Loading config ...
[2025-01-07 00:20:50,796 INFO train.py line 135 2420243] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:20:51,100 INFO train.py line 136 2420243] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 53072942
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [1.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-07 00:20:51,101 INFO train.py line 137 2420243] => Building model ...
[2025-01-07 00:20:51,669 INFO train.py line 427 2420243] Num params: 1634304
[2025-01-07 00:20:51,742 INFO train.py line 139 2420243] => Building writer ...
[2025-01-07 00:20:51,753 INFO train.py line 437 2420243] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 00:20:51,754 INFO train.py line 141 2420243] => Building train dataset & dataloader ...
[2025-01-07 00:21:32,684 INFO dataset_render_16views.py line 145 2420243] Processing frame_0
[2025-01-07 00:21:35,360 INFO dataset_render_16views.py line 145 2420243] Processing frame_1
[2025-01-07 00:21:37,853 INFO dataset_render_16views.py line 145 2420243] Processing frame_2
[2025-01-07 00:21:40,162 INFO dataset_render_16views.py line 145 2420243] Processing frame_3
[2025-01-07 00:21:42,459 INFO dataset_render_16views.py line 145 2420243] Processing frame_4
[2025-01-07 00:21:44,884 INFO dataset_render_16views.py line 145 2420243] Processing frame_5
[2025-01-07 00:21:47,200 INFO dataset_render_16views.py line 145 2420243] Processing frame_6
[2025-01-07 00:21:49,407 INFO dataset_render_16views.py line 145 2420243] Processing frame_7
[2025-01-07 00:21:51,673 INFO dataset_render_16views.py line 145 2420243] Processing frame_8
[2025-01-07 00:21:54,155 INFO dataset_render_16views.py line 145 2420243] Processing frame_9
[2025-01-07 00:21:56,431 INFO dataset_render_16views.py line 145 2420243] Processing frame_10
[2025-01-07 00:21:58,736 INFO dataset_render_16views.py line 145 2420243] Processing frame_11
[2025-01-07 00:22:00,962 INFO dataset_render_16views.py line 145 2420243] Processing frame_12
[2025-01-07 00:22:03,413 INFO dataset_render_16views.py line 145 2420243] Processing frame_13
[2025-01-07 00:22:05,623 INFO dataset_render_16views.py line 145 2420243] Processing frame_14
[2025-01-07 00:22:07,908 INFO dataset_render_16views.py line 145 2420243] Processing frame_15
[2025-01-07 00:22:10,217 INFO dataset_render_16views.py line 69 2420243] Totally 16 x 1 samples in train set.
[2025-01-07 00:22:10,217 INFO train.py line 145 2420243] => Building optimize, scheduler, scaler(amp) ...
[2025-01-07 00:22:10,218 INFO optimizer.py line 64 2420243] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-07 00:22:10,219 INFO train.py line 149 2420243] => Building hooks ...
[2025-01-07 00:22:10,220 INFO train.py line 166 2420243] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-07 00:22:10,220 INFO train.py line 171 2420243] => Loading checkpoint & weight ...
[2025-01-07 00:22:10,385 INFO train.py line 192 2420243] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-07 00:22:10,883 INFO train.py line 211 2420243] iter: 0, total_loss: 0.44348520040512085, loss_1: 0.410400390625, loss_2: 0.406494140625, loss_3: 0.28662109375
[2025-01-07 00:22:12,780 INFO train.py line 211 2420243] iter: 10, total_loss: 0.36637741327285767, loss_1: 0.385498046875, loss_2: 0.4111328125, loss_3: 0.2320556640625
[2025-01-07 00:22:14,633 INFO train.py line 211 2420243] iter: 20, total_loss: 0.3849698007106781, loss_1: 0.434814453125, loss_2: 0.43359375, loss_3: 0.1507568359375
[2025-01-07 00:22:16,478 INFO train.py line 211 2420243] iter: 30, total_loss: 0.2727970480918884, loss_1: 0.40771484375, loss_2: 0.406982421875, loss_3: 0.060211181640625
[2025-01-07 00:22:18,352 INFO train.py line 211 2420243] iter: 40, total_loss: 0.258748322725296, loss_1: 0.33544921875, loss_2: 0.3310546875, loss_3: 0.03985595703125
[2025-01-07 00:22:20,253 INFO train.py line 211 2420243] iter: 50, total_loss: 0.2207268625497818, loss_1: 0.298095703125, loss_2: 0.27734375, loss_3: 0.028228759765625
[2025-01-07 00:22:22,153 INFO train.py line 211 2420243] iter: 60, total_loss: 0.1451013833284378, loss_1: 0.205322265625, loss_2: 0.1605224609375, loss_3: 0.029754638671875
[2025-01-07 00:22:24,025 INFO train.py line 211 2420243] iter: 70, total_loss: 0.1099017858505249, loss_1: 0.1845703125, loss_2: 0.1326904296875, loss_3: 0.041473388671875
[2025-01-07 00:22:25,890 INFO train.py line 211 2420243] iter: 80, total_loss: 0.12344764173030853, loss_1: 0.158935546875, loss_2: 0.157470703125, loss_3: 0.037811279296875
[2025-01-07 00:22:27,767 INFO train.py line 211 2420243] iter: 90, total_loss: 0.10796195268630981, loss_1: 0.149658203125, loss_2: 0.11248779296875, loss_3: 0.024688720703125
[2025-01-07 00:22:29,689 INFO train.py line 211 2420243] iter: 100, total_loss: 0.1165924072265625, loss_1: 0.1610107421875, loss_2: 0.1556396484375, loss_3: 0.0364990234375
[2025-01-07 00:22:31,577 INFO train.py line 211 2420243] iter: 110, total_loss: 0.12003054469823837, loss_1: 0.220458984375, loss_2: 0.155517578125, loss_3: 0.0130615234375
[2025-01-07 00:22:33,458 INFO train.py line 211 2420243] iter: 120, total_loss: 0.09870190173387527, loss_1: 0.143798828125, loss_2: 0.121337890625, loss_3: 0.0281829833984375
[2025-01-07 00:22:35,347 INFO train.py line 211 2420243] iter: 130, total_loss: 0.11154379695653915, loss_1: 0.20703125, loss_2: 0.06976318359375, loss_3: 0.058502197265625
[2025-01-07 00:22:37,266 INFO train.py line 211 2420243] iter: 140, total_loss: 0.10076628625392914, loss_1: 0.09832763671875, loss_2: 0.097412109375, loss_3: 0.052001953125
[2025-01-07 00:22:39,131 INFO train.py line 211 2420243] iter: 150, total_loss: 0.10643068701028824, loss_1: 0.190673828125, loss_2: 0.103271484375, loss_3: 0.005390167236328125
[2025-01-07 00:22:40,996 INFO train.py line 211 2420243] iter: 160, total_loss: 0.07608556002378464, loss_1: 0.1199951171875, loss_2: 0.10369873046875, loss_3: 0.0233306884765625
[2025-01-07 00:22:42,883 INFO train.py line 211 2420243] iter: 170, total_loss: 0.07398434728384018, loss_1: 0.11114501953125, loss_2: 0.10906982421875, loss_3: 0.021148681640625
[2025-01-07 00:22:44,787 INFO train.py line 211 2420243] iter: 180, total_loss: 0.08623877912759781, loss_1: 0.11505126953125, loss_2: 0.1134033203125, loss_3: 0.0257110595703125
[2025-01-07 00:22:46,667 INFO train.py line 211 2420243] iter: 190, total_loss: 0.05702134221792221, loss_1: 0.0948486328125, loss_2: 0.048797607421875, loss_3: 0.022857666015625
[2025-01-07 00:22:48,529 INFO train.py line 211 2420243] iter: 200, total_loss: 0.059191297739744186, loss_1: 0.07720947265625, loss_2: 0.0472412109375, loss_3: 0.0335693359375
[2025-01-07 00:22:50,430 INFO train.py line 211 2420243] iter: 210, total_loss: 0.05944543704390526, loss_1: 0.07696533203125, loss_2: 0.048248291015625, loss_3: 0.03265380859375
[2025-01-07 00:22:52,312 INFO train.py line 211 2420243] iter: 220, total_loss: 0.07483287900686264, loss_1: 0.0982666015625, loss_2: 0.09320068359375, loss_3: 0.0304107666015625
[2025-01-07 00:22:54,157 INFO train.py line 211 2420243] iter: 230, total_loss: 0.06352078169584274, loss_1: 0.0875244140625, loss_2: 0.08636474609375, loss_3: 0.0208282470703125
[2025-01-07 00:22:56,038 INFO train.py line 211 2420243] iter: 240, total_loss: 0.06127595901489258, loss_1: 0.11395263671875, loss_2: 0.050384521484375, loss_3: 0.0205078125
[2025-01-07 00:22:57,885 INFO train.py line 211 2420243] iter: 250, total_loss: 0.06473660469055176, loss_1: 0.09014892578125, loss_2: 0.0821533203125, loss_3: 0.0177001953125
[2025-01-07 00:22:59,785 INFO train.py line 211 2420243] iter: 260, total_loss: 0.06072632223367691, loss_1: 0.116943359375, loss_2: 0.0399169921875, loss_3: 0.01861572265625
[2025-01-07 00:23:01,629 INFO train.py line 211 2420243] iter: 270, total_loss: 0.07022840529680252, loss_1: 0.1468505859375, loss_2: 0.07635498046875, loss_3: 0.0150299072265625
[2025-01-07 00:23:03,519 INFO train.py line 211 2420243] iter: 280, total_loss: 0.05431639403104782, loss_1: 0.07977294921875, loss_2: 0.058746337890625, loss_3: 0.02490234375
[2025-01-07 00:23:05,405 INFO train.py line 211 2420243] iter: 290, total_loss: 0.05068301036953926, loss_1: 0.091064453125, loss_2: 0.04150390625, loss_3: 0.0196990966796875
[2025-01-07 00:23:07,279 INFO train.py line 211 2420243] iter: 300, total_loss: 0.0583907812833786, loss_1: 0.07403564453125, loss_2: 0.0692138671875, loss_3: 0.018829345703125
[2025-01-07 00:23:09,152 INFO train.py line 211 2420243] iter: 310, total_loss: 0.06578164547681808, loss_1: 0.148681640625, loss_2: 0.047393798828125, loss_3: 0.0054779052734375
[2025-01-07 00:23:11,030 INFO train.py line 211 2420243] iter: 320, total_loss: 0.04572504758834839, loss_1: 0.0714111328125, loss_2: 0.0369873046875, loss_3: 0.020660400390625
[2025-01-07 00:23:12,883 INFO train.py line 211 2420243] iter: 330, total_loss: 0.04817308485507965, loss_1: 0.0592041015625, loss_2: 0.056427001953125, loss_3: 0.023406982421875
[2025-01-07 00:23:14,744 INFO train.py line 211 2420243] iter: 340, total_loss: 0.058268286287784576, loss_1: 0.09228515625, loss_2: 0.072021484375, loss_3: 0.015838623046875
[2025-01-07 00:23:16,636 INFO train.py line 211 2420243] iter: 350, total_loss: 0.05662000924348831, loss_1: 0.07305908203125, loss_2: 0.07049560546875, loss_3: 0.021820068359375
[2025-01-07 00:23:18,541 INFO train.py line 211 2420243] iter: 360, total_loss: 0.06261849403381348, loss_1: 0.099609375, loss_2: 0.048370361328125, loss_3: 0.00713348388671875
[2025-01-07 00:23:20,464 INFO train.py line 211 2420243] iter: 370, total_loss: 0.084532231092453, loss_1: 0.1298828125, loss_2: 0.08453369140625, loss_3: 0.01081085205078125
[2025-01-07 00:23:22,381 INFO train.py line 211 2420243] iter: 380, total_loss: 0.049504220485687256, loss_1: 0.0689697265625, loss_2: 0.0462646484375, loss_3: 0.0244140625
[2025-01-07 00:23:24,301 INFO train.py line 211 2420243] iter: 390, total_loss: 0.05370888113975525, loss_1: 0.0653076171875, loss_2: 0.059600830078125, loss_3: 0.0228118896484375
[2025-01-07 00:23:26,181 INFO train.py line 211 2420243] iter: 400, total_loss: 0.05240985006093979, loss_1: 0.0499267578125, loss_2: 0.044403076171875, loss_3: 0.035491943359375
[2025-01-07 00:23:28,077 INFO train.py line 211 2420243] iter: 410, total_loss: 0.07384470105171204, loss_1: 0.11651611328125, loss_2: 0.086181640625, loss_3: 0.01499176025390625
[2025-01-07 00:23:30,028 INFO train.py line 211 2420243] iter: 420, total_loss: 0.059552110731601715, loss_1: 0.12255859375, loss_2: 0.033721923828125, loss_3: 0.0174713134765625
[2025-01-07 00:23:31,911 INFO train.py line 211 2420243] iter: 430, total_loss: 0.05085230618715286, loss_1: 0.053619384765625, loss_2: 0.049163818359375, loss_3: 0.0289459228515625
[2025-01-07 00:23:33,808 INFO train.py line 211 2420243] iter: 440, total_loss: 0.05841913819313049, loss_1: 0.08233642578125, loss_2: 0.0701904296875, loss_3: 0.0159759521484375
[2025-01-07 00:23:35,734 INFO train.py line 211 2420243] iter: 450, total_loss: 0.08324170112609863, loss_1: 0.1065673828125, loss_2: 0.095947265625, loss_3: 0.00769805908203125
[2025-01-07 00:23:37,641 INFO train.py line 211 2420243] iter: 460, total_loss: 0.11482162773609161, loss_1: 0.145263671875, loss_2: 0.1370849609375, loss_3: 0.00620269775390625
[2025-01-07 00:23:39,544 INFO train.py line 211 2420243] iter: 470, total_loss: 0.04839641973376274, loss_1: 0.0743408203125, loss_2: 0.042999267578125, loss_3: 0.0199127197265625
[2025-01-07 00:23:41,494 INFO train.py line 211 2420243] iter: 480, total_loss: 0.04720345139503479, loss_1: 0.07293701171875, loss_2: 0.042938232421875, loss_3: 0.00952911376953125
[2025-01-07 00:23:43,412 INFO train.py line 211 2420243] iter: 490, total_loss: 0.04371631518006325, loss_1: 0.05755615234375, loss_2: 0.036651611328125, loss_3: 0.0224609375
[2025-01-07 00:23:45,118 INFO train.py line 248 2420243] => Loading checkpoint & weight ...
[2025-01-07 00:23:45,118 INFO train.py line 257 2420243] No weight found at: None
[2025-01-07 00:23:45,567 INFO train.py line 324 2420243] scale_1.0 has 27 groups, mesh_voting: True
[2025-01-07 00:23:45,579 INFO train.py line 359 2420243] shape of mesh_group (36457,)
[2025-01-07 00:23:45,835 INFO train.py line 367 2420243] Mesh has 36457 faces
[2025-01-07 13:41:27,815 INFO train.py line 133 3095443] => Loading config ...
[2025-01-07 13:41:27,815 INFO train.py line 135 3095443] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 13:41:28,115 INFO train.py line 136 3095443] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 30782970
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [1.2]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-07 13:41:28,115 INFO train.py line 137 3095443] => Building model ...
[2025-01-07 13:41:28,679 INFO train.py line 427 3095443] Num params: 1634304
[2025-01-07 13:41:28,751 INFO train.py line 139 3095443] => Building writer ...
[2025-01-07 13:41:28,761 INFO train.py line 437 3095443] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-07 13:41:28,761 INFO train.py line 141 3095443] => Building train dataset & dataloader ...
[2025-01-07 13:42:09,686 INFO dataset_render_16views.py line 145 3095443] Processing frame_0
[2025-01-07 13:42:12,343 INFO dataset_render_16views.py line 145 3095443] Processing frame_1
[2025-01-07 13:42:14,847 INFO dataset_render_16views.py line 145 3095443] Processing frame_2
[2025-01-07 13:42:17,188 INFO dataset_render_16views.py line 145 3095443] Processing frame_3
[2025-01-07 13:42:19,567 INFO dataset_render_16views.py line 145 3095443] Processing frame_4
[2025-01-07 13:42:21,998 INFO dataset_render_16views.py line 145 3095443] Processing frame_5
[2025-01-07 13:42:24,318 INFO dataset_render_16views.py line 145 3095443] Processing frame_6
[2025-01-07 13:42:26,787 INFO dataset_render_16views.py line 145 3095443] Processing frame_7
[2025-01-07 13:42:29,083 INFO dataset_render_16views.py line 145 3095443] Processing frame_8
[2025-01-07 13:42:31,649 INFO dataset_render_16views.py line 145 3095443] Processing frame_9
[2025-01-07 13:42:33,924 INFO dataset_render_16views.py line 145 3095443] Processing frame_10
[2025-01-07 13:42:36,252 INFO dataset_render_16views.py line 145 3095443] Processing frame_11
[2025-01-07 13:42:38,527 INFO dataset_render_16views.py line 145 3095443] Processing frame_12
[2025-01-07 13:42:40,932 INFO dataset_render_16views.py line 145 3095443] Processing frame_13
[2025-01-07 13:42:43,252 INFO dataset_render_16views.py line 145 3095443] Processing frame_14
[2025-01-07 13:42:45,531 INFO dataset_render_16views.py line 145 3095443] Processing frame_15
[2025-01-07 13:42:47,832 INFO dataset_render_16views.py line 69 3095443] Totally 16 x 1 samples in train set.
[2025-01-07 13:42:47,833 INFO train.py line 145 3095443] => Building optimize, scheduler, scaler(amp) ...
[2025-01-07 13:42:47,834 INFO optimizer.py line 64 3095443] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-07 13:42:47,834 INFO train.py line 149 3095443] => Building hooks ...
[2025-01-07 13:42:47,836 INFO train.py line 166 3095443] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-07 13:42:47,836 INFO train.py line 171 3095443] => Loading checkpoint & weight ...
[2025-01-07 13:42:48,050 INFO train.py line 192 3095443] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-07 13:42:48,538 INFO train.py line 211 3095443] iter: 0, total_loss: 0.5260906219482422, loss_1: 0.34716796875, loss_2: 0.399658203125, loss_3: 0.446533203125
[2025-01-07 13:42:50,420 INFO train.py line 211 3095443] iter: 10, total_loss: 0.4013022780418396, loss_1: 0.42724609375, loss_2: 0.42333984375, loss_3: 0.22021484375
[2025-01-07 13:42:52,294 INFO train.py line 211 3095443] iter: 20, total_loss: 0.3436962366104126, loss_1: 0.429443359375, loss_2: 0.4267578125, loss_3: 0.12890625
[2025-01-07 13:42:54,194 INFO train.py line 211 3095443] iter: 30, total_loss: 0.36673787236213684, loss_1: 0.442138671875, loss_2: 0.43408203125, loss_3: 0.047607421875
[2025-01-07 13:42:56,099 INFO train.py line 211 3095443] iter: 40, total_loss: 0.20314332842826843, loss_1: 0.3251953125, loss_2: 0.319091796875, loss_3: 0.05157470703125
[2025-01-07 13:42:58,001 INFO train.py line 211 3095443] iter: 50, total_loss: 0.16063573956489563, loss_1: 0.27685546875, loss_2: 0.2152099609375, loss_3: 0.033905029296875
[2025-01-07 13:42:59,858 INFO train.py line 211 3095443] iter: 60, total_loss: 0.1261458545923233, loss_1: 0.1793212890625, loss_2: 0.1417236328125, loss_3: 0.04119873046875
[2025-01-07 13:43:01,746 INFO train.py line 211 3095443] iter: 70, total_loss: 0.11135107278823853, loss_1: 0.2269287109375, loss_2: 0.11016845703125, loss_3: 0.0206298828125
[2025-01-07 13:43:03,603 INFO train.py line 211 3095443] iter: 80, total_loss: 0.10464124381542206, loss_1: 0.2069091796875, loss_2: 0.10760498046875, loss_3: 0.029296875
[2025-01-07 13:43:05,451 INFO train.py line 211 3095443] iter: 90, total_loss: 0.09473425149917603, loss_1: 0.162109375, loss_2: 0.09674072265625, loss_3: 0.03472900390625
[2025-01-07 13:43:07,357 INFO train.py line 211 3095443] iter: 100, total_loss: 0.10493447631597519, loss_1: 0.1466064453125, loss_2: 0.146240234375, loss_3: 0.0282745361328125
[2025-01-07 13:43:09,232 INFO train.py line 211 3095443] iter: 110, total_loss: 0.08973182737827301, loss_1: 0.11248779296875, loss_2: 0.09161376953125, loss_3: 0.039459228515625
[2025-01-07 13:43:11,126 INFO train.py line 211 3095443] iter: 120, total_loss: 0.06833444535732269, loss_1: 0.10601806640625, loss_2: 0.07647705078125, loss_3: 0.0255889892578125
[2025-01-07 13:43:12,999 INFO train.py line 211 3095443] iter: 130, total_loss: 0.07871703803539276, loss_1: 0.10882568359375, loss_2: 0.09979248046875, loss_3: 0.031341552734375
[2025-01-07 13:43:14,890 INFO train.py line 211 3095443] iter: 140, total_loss: 0.08323287218809128, loss_1: 0.1258544921875, loss_2: 0.07916259765625, loss_3: 0.025177001953125
[2025-01-07 13:43:16,774 INFO train.py line 211 3095443] iter: 150, total_loss: 0.07695966958999634, loss_1: 0.122314453125, loss_2: 0.0677490234375, loss_3: 0.010711669921875
[2025-01-07 13:43:18,653 INFO train.py line 211 3095443] iter: 160, total_loss: 0.06789971888065338, loss_1: 0.1087646484375, loss_2: 0.064453125, loss_3: 0.02618408203125
[2025-01-07 13:43:20,549 INFO train.py line 211 3095443] iter: 170, total_loss: 0.08287079632282257, loss_1: 0.119873046875, loss_2: 0.11676025390625, loss_3: 0.01812744140625
[2025-01-07 13:43:22,462 INFO train.py line 211 3095443] iter: 180, total_loss: 0.05801853537559509, loss_1: 0.0772705078125, loss_2: 0.07183837890625, loss_3: 0.020904541015625
[2025-01-07 13:43:24,351 INFO train.py line 211 3095443] iter: 190, total_loss: 0.06852927803993225, loss_1: 0.0888671875, loss_2: 0.064208984375, loss_3: 0.02557373046875
[2025-01-07 13:43:26,195 INFO train.py line 211 3095443] iter: 200, total_loss: 0.06643962860107422, loss_1: 0.094970703125, loss_2: 0.059234619140625, loss_3: 0.027984619140625
[2025-01-07 13:43:28,084 INFO train.py line 211 3095443] iter: 210, total_loss: 0.16551505029201508, loss_1: 0.25048828125, loss_2: 0.21728515625, loss_3: 0.004505157470703125
[2025-01-07 13:43:29,969 INFO train.py line 211 3095443] iter: 220, total_loss: 0.06524401903152466, loss_1: 0.10186767578125, loss_2: 0.0849609375, loss_3: 0.017333984375
[2025-01-07 13:43:31,868 INFO train.py line 211 3095443] iter: 230, total_loss: 0.05720992013812065, loss_1: 0.060455322265625, loss_2: 0.04632568359375, loss_3: 0.03955078125
[2025-01-07 13:43:33,753 INFO train.py line 211 3095443] iter: 240, total_loss: 0.05613747984170914, loss_1: 0.07415771484375, loss_2: 0.0604248046875, loss_3: 0.01526641845703125
[2025-01-07 13:43:35,646 INFO train.py line 211 3095443] iter: 250, total_loss: 0.055090755224227905, loss_1: 0.06982421875, loss_2: 0.04364013671875, loss_3: 0.0297393798828125
[2025-01-07 13:43:37,532 INFO train.py line 211 3095443] iter: 260, total_loss: 0.06003975868225098, loss_1: 0.08221435546875, loss_2: 0.062042236328125, loss_3: 0.02203369140625
[2025-01-07 13:43:39,413 INFO train.py line 211 3095443] iter: 270, total_loss: 0.049736276268959045, loss_1: 0.07696533203125, loss_2: 0.0367431640625, loss_3: 0.020782470703125
[2025-01-07 13:43:41,252 INFO train.py line 211 3095443] iter: 280, total_loss: 0.05648587644100189, loss_1: 0.08441162109375, loss_2: 0.060577392578125, loss_3: 0.0212860107421875
[2025-01-07 13:43:43,116 INFO train.py line 211 3095443] iter: 290, total_loss: 0.06846019625663757, loss_1: 0.11383056640625, loss_2: 0.0665283203125, loss_3: 0.014495849609375
[2025-01-07 13:43:45,018 INFO train.py line 211 3095443] iter: 300, total_loss: 0.051412131637334824, loss_1: 0.07196044921875, loss_2: 0.038604736328125, loss_3: 0.028594970703125
[2025-01-07 13:43:46,887 INFO train.py line 211 3095443] iter: 310, total_loss: 0.0715622827410698, loss_1: 0.131103515625, loss_2: 0.09039306640625, loss_3: 0.0164947509765625
[2025-01-07 13:43:48,782 INFO train.py line 211 3095443] iter: 320, total_loss: 0.07904943823814392, loss_1: 0.111328125, loss_2: 0.08734130859375, loss_3: 0.00814056396484375
[2025-01-07 13:43:50,653 INFO train.py line 211 3095443] iter: 330, total_loss: 0.04714897274971008, loss_1: 0.07427978515625, loss_2: 0.039337158203125, loss_3: 0.022186279296875
[2025-01-07 13:43:52,536 INFO train.py line 211 3095443] iter: 340, total_loss: 0.04035910964012146, loss_1: 0.060211181640625, loss_2: 0.04046630859375, loss_3: 0.0203704833984375
[2025-01-07 13:43:54,398 INFO train.py line 211 3095443] iter: 350, total_loss: 0.04793491214513779, loss_1: 0.043487548828125, loss_2: 0.03387451171875, loss_3: 0.033538818359375
[2025-01-07 13:43:56,296 INFO train.py line 211 3095443] iter: 360, total_loss: 0.05464916303753853, loss_1: 0.10162353515625, loss_2: 0.065673828125, loss_3: 0.01035308837890625
[2025-01-07 13:43:58,171 INFO train.py line 211 3095443] iter: 370, total_loss: 0.06031249836087227, loss_1: 0.083740234375, loss_2: 0.0771484375, loss_3: 0.02001953125
[2025-01-07 13:44:00,050 INFO train.py line 211 3095443] iter: 380, total_loss: 0.05110974237322807, loss_1: 0.09979248046875, loss_2: 0.038726806640625, loss_3: 0.010986328125
[2025-01-07 13:44:01,918 INFO train.py line 211 3095443] iter: 390, total_loss: 0.04498887062072754, loss_1: 0.07159423828125, loss_2: 0.047210693359375, loss_3: 0.018646240234375
[2025-01-07 13:44:03,809 INFO train.py line 211 3095443] iter: 400, total_loss: 0.05055532604455948, loss_1: 0.09124755859375, loss_2: 0.04632568359375, loss_3: 0.0116424560546875
[2025-01-07 13:44:05,699 INFO train.py line 211 3095443] iter: 410, total_loss: 0.06165158376097679, loss_1: 0.09661865234375, loss_2: 0.0799560546875, loss_3: 0.0177001953125
[2025-01-07 13:44:07,536 INFO train.py line 211 3095443] iter: 420, total_loss: 0.07329344004392624, loss_1: 0.10797119140625, loss_2: 0.06195068359375, loss_3: 0.0181427001953125
[2025-01-07 13:44:09,409 INFO train.py line 211 3095443] iter: 430, total_loss: 0.05176043137907982, loss_1: 0.0628662109375, loss_2: 0.059234619140625, loss_3: 0.0217132568359375
[2025-01-07 13:44:11,309 INFO train.py line 211 3095443] iter: 440, total_loss: 0.045415930449962616, loss_1: 0.057891845703125, loss_2: 0.032928466796875, loss_3: 0.0250091552734375
[2025-01-07 13:44:13,187 INFO train.py line 211 3095443] iter: 450, total_loss: 0.06510674953460693, loss_1: 0.1005859375, loss_2: 0.060638427734375, loss_3: 0.01076507568359375
[2025-01-07 13:44:15,055 INFO train.py line 211 3095443] iter: 460, total_loss: 0.0510357990860939, loss_1: 0.07598876953125, loss_2: 0.04168701171875, loss_3: 0.019683837890625
[2025-01-07 13:44:16,937 INFO train.py line 211 3095443] iter: 470, total_loss: 0.07424534857273102, loss_1: 0.10888671875, loss_2: 0.09869384765625, loss_3: 0.01512908935546875
[2025-01-07 13:44:18,846 INFO train.py line 211 3095443] iter: 480, total_loss: 0.0699218213558197, loss_1: 0.1153564453125, loss_2: 0.08050537109375, loss_3: 0.006744384765625
[2025-01-07 13:44:20,736 INFO train.py line 211 3095443] iter: 490, total_loss: 0.0446636937558651, loss_1: 0.0762939453125, loss_2: 0.035369873046875, loss_3: 0.0187835693359375
[2025-01-07 13:44:22,436 INFO train.py line 248 3095443] => Loading checkpoint & weight ...
[2025-01-07 13:44:22,436 INFO train.py line 257 3095443] No weight found at: None
[2025-01-07 13:44:22,887 INFO train.py line 324 3095443] scale_1.2 has 25 groups, mesh_voting: True
[2025-01-07 13:44:22,899 INFO train.py line 359 3095443] shape of mesh_group (36457,)
[2025-01-07 13:44:23,140 INFO train.py line 367 3095443] Mesh has 36457 faces
[2025-01-15 16:27:58,478 INFO train.py line 133 4010323] => Loading config ...
[2025-01-15 16:27:58,478 INFO train.py line 135 4010323] Save path: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-15 16:27:58,782 INFO train.py line 136 4010323] Config:
weight = None
resume = False
evaluate = True
test_only = False
seed = 62324656
save_path = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0'
num_worker = 1
batch_size = 1
batch_size_val = None
batch_size_test = None
epoch = 500
eval_epoch = 500
sync_bn = False
enable_amp = True
empty_cache = False
find_unused_parameters = False
mix_prob = 0
param_dicts = None
hooks = [
    dict(type='CheckpointLoader'),
    dict(type='IterationTimer', warmup_iter=2),
    dict(type='InformationWriter'),
    dict(type='CheckpointSaver', save_freq=None)
]
train = dict(type='DefaultTrainer')
test = dict(type='SemSegTester', verbose=True)
model = dict(
    type='SAMPart3D',
    backbone_dim=384,
    output_dim=384,
    pcd_feat_dim=9,
    freeze_backbone=True,
    max_grouping_scale=2,
    use_hierarchy_losses=True,
    backbone=dict(
        type='PTv3-obj',
        in_channels=9,
        order=['z', 'z-trans', 'hilbert', 'hilbert-trans'],
        stride=(),
        enc_depths=(3, 3, 3, 6, 16),
        enc_channels=(32, 64, 128, 256, 384),
        enc_num_head=(2, 4, 8, 16, 24),
        enc_patch_size=(1024, 1024, 1024, 1024, 1024),
        mlp_ratio=4,
        qkv_bias=True,
        qk_scale=None,
        attn_drop=0.0,
        proj_drop=0.0,
        drop_path=0.0,
        shuffle_orders=False,
        pre_norm=True,
        enable_rpe=False,
        enable_flash=True,
        upcast_attention=False,
        upcast_softmax=False,
        cls_mode=False))
optimizer = dict(type='AdamW', lr=0.0001, weight_decay=1e-08)
scheduler = dict(
    type='OneCycleLR',
    max_lr=[0.0001],
    pct_start=0.1,
    anneal_strategy='cos',
    div_factor=10.0,
    final_div_factor=10.0)
dataset_type = 'SAMPart3DDataset16Views'
data_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render'
mesh_root = '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh'
backbone_weight_path = '/home/rvsa/gary318/SAMPart3D/ckpt/ptv3-object.pth'
val_scales_list = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0]
mesh_voting = True
data = dict(
    train=dict(
        type='SAMPart3DDataset16Views',
        split='train',
        data_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/render',
        mesh_root=
        '/home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/mesh',
        sample_num=15000,
        pixels_per_image=256,
        batch_size=90,
        extent_scale=10.0,
        transform=[
            dict(type='NormalizeCoord'),
            dict(type='CenterShift', apply_z=True),
            dict(
                type='GridSample',
                grid_size=0.01,
                keys=('coord', 'color', 'normal', 'origin_coord',
                      'face_index'),
                hash_type='fnv',
                mode='train',
                return_grid_coord=True,
                return_inverse=True),
            dict(type='CenterShift', apply_z=False),
            dict(type='NormalizeColor'),
            dict(type='ToTensor'),
            dict(
                type='Collect',
                keys=('coord', 'grid_coord', 'inverse', 'origin_coord',
                      'face_index'),
                feat_keys=('coord', 'normal', 'color'))
        ],
        loop=1))
oid = 'state_0'
label = 'None'
num_worker_per_gpu = 1
batch_size_per_gpu = 1
batch_size_val_per_gpu = 1
batch_size_test_per_gpu = 1

[2025-01-15 16:27:58,782 INFO train.py line 137 4010323] => Building model ...
[2025-01-15 16:27:59,350 INFO train.py line 429 4010323] Num params: 1634304
[2025-01-15 16:27:59,433 INFO train.py line 139 4010323] => Building writer ...
[2025-01-15 16:27:59,466 INFO train.py line 439 4010323] Tensorboard writer logging dir: /home/rvsa/gary318/build_kinematic/input_rgbd/010602_fridge/SAM3D/state_0
[2025-01-15 16:27:59,466 INFO train.py line 141 4010323] => Building train dataset & dataloader ...
[2025-01-15 16:28:40,380 INFO dataset_render_16views.py line 145 4010323] Processing frame_0
[2025-01-15 16:28:42,929 INFO dataset_render_16views.py line 145 4010323] Processing frame_1
[2025-01-15 16:28:45,110 INFO dataset_render_16views.py line 145 4010323] Processing frame_2
[2025-01-15 16:28:47,257 INFO dataset_render_16views.py line 145 4010323] Processing frame_3
[2025-01-15 16:28:49,418 INFO dataset_render_16views.py line 145 4010323] Processing frame_4
[2025-01-15 16:28:51,711 INFO dataset_render_16views.py line 145 4010323] Processing frame_5
[2025-01-15 16:28:53,945 INFO dataset_render_16views.py line 145 4010323] Processing frame_6
[2025-01-15 16:28:56,082 INFO dataset_render_16views.py line 145 4010323] Processing frame_7
[2025-01-15 16:28:58,286 INFO dataset_render_16views.py line 145 4010323] Processing frame_8
[2025-01-15 16:29:00,633 INFO dataset_render_16views.py line 145 4010323] Processing frame_9
[2025-01-15 16:29:02,869 INFO dataset_render_16views.py line 145 4010323] Processing frame_10
[2025-01-15 16:29:04,980 INFO dataset_render_16views.py line 145 4010323] Processing frame_11
[2025-01-15 16:29:07,136 INFO dataset_render_16views.py line 145 4010323] Processing frame_12
[2025-01-15 16:29:09,392 INFO dataset_render_16views.py line 145 4010323] Processing frame_13
[2025-01-15 16:29:11,575 INFO dataset_render_16views.py line 145 4010323] Processing frame_14
[2025-01-15 16:29:13,662 INFO dataset_render_16views.py line 145 4010323] Processing frame_15
[2025-01-15 16:29:15,889 INFO dataset_render_16views.py line 69 4010323] Totally 16 x 1 samples in train set.
[2025-01-15 16:29:15,889 INFO train.py line 145 4010323] => Building optimize, scheduler, scaler(amp) ...
[2025-01-15 16:29:15,891 INFO optimizer.py line 64 4010323] Params Group 1 - lr: 0.0001; Params: ['instance_net.params', 'pos_net.params'].
[2025-01-15 16:29:15,891 INFO train.py line 149 4010323] => Building hooks ...
[2025-01-15 16:29:15,893 INFO train.py line 166 4010323] >>>>>>>>>>>>>>>> Start Training >>>>>>>>>>>>>>>>
[2025-01-15 16:29:15,893 INFO train.py line 171 4010323] => Loading checkpoint & weight ...
[2025-01-15 16:29:16,053 INFO train.py line 192 4010323] Missing keys: ['scale_statistics', 'instance_net.params', 'pos_net.params']
[2025-01-15 16:29:16,547 INFO train.py line 211 4010323] iter: 0, total_loss: 0.4161098599433899, loss_1: 0.390869140625, loss_2: 0.386962890625, loss_3: 0.3046875
[2025-01-15 16:29:18,375 INFO train.py line 211 4010323] iter: 10, total_loss: 0.3870925009250641, loss_1: 0.422119140625, loss_2: 0.422119140625, loss_3: 0.245361328125
[2025-01-15 16:29:20,260 INFO train.py line 211 4010323] iter: 20, total_loss: 0.29362785816192627, loss_1: 0.472900390625, loss_2: 0.45751953125, loss_3: 0.10797119140625
[2025-01-15 16:29:22,121 INFO train.py line 211 4010323] iter: 30, total_loss: 0.26840680837631226, loss_1: 0.4404296875, loss_2: 0.413330078125, loss_3: 0.0609130859375
[2025-01-15 16:29:23,982 INFO train.py line 211 4010323] iter: 40, total_loss: 0.21540480852127075, loss_1: 0.33544921875, loss_2: 0.3330078125, loss_3: 0.07562255859375
[2025-01-15 16:29:25,872 INFO train.py line 211 4010323] iter: 50, total_loss: 0.18186306953430176, loss_1: 0.32080078125, loss_2: 0.308837890625, loss_3: 0.05743408203125
[2025-01-15 16:29:27,756 INFO train.py line 211 4010323] iter: 60, total_loss: 0.14171293377876282, loss_1: 0.277099609375, loss_2: 0.16650390625, loss_3: 0.04290771484375
[2025-01-15 16:29:29,612 INFO train.py line 211 4010323] iter: 70, total_loss: 0.12848003208637238, loss_1: 0.264404296875, loss_2: 0.15576171875, loss_3: 0.032470703125
[2025-01-15 16:29:31,501 INFO train.py line 211 4010323] iter: 80, total_loss: 0.11850007623434067, loss_1: 0.2120361328125, loss_2: 0.17529296875, loss_3: 0.028839111328125
[2025-01-15 16:29:33,385 INFO train.py line 211 4010323] iter: 90, total_loss: 0.11526601016521454, loss_1: 0.1982421875, loss_2: 0.1065673828125, loss_3: 0.06207275390625
[2025-01-15 16:29:35,245 INFO train.py line 211 4010323] iter: 100, total_loss: 0.09448157250881195, loss_1: 0.1492919921875, loss_2: 0.1136474609375, loss_3: 0.043731689453125
[2025-01-15 16:29:37,130 INFO train.py line 211 4010323] iter: 110, total_loss: 0.09018991887569427, loss_1: 0.10284423828125, loss_2: 0.08984375, loss_3: 0.05859375
[2025-01-15 16:29:39,003 INFO train.py line 211 4010323] iter: 120, total_loss: 0.09181031584739685, loss_1: 0.137939453125, loss_2: 0.0986328125, loss_3: 0.040283203125
[2025-01-15 16:29:40,866 INFO train.py line 211 4010323] iter: 130, total_loss: 0.09510474652051926, loss_1: 0.145263671875, loss_2: 0.087646484375, loss_3: 0.05743408203125
[2025-01-15 16:29:42,746 INFO train.py line 211 4010323] iter: 140, total_loss: 0.08343813568353653, loss_1: 0.11126708984375, loss_2: 0.1033935546875, loss_3: 0.04705810546875
[2025-01-15 16:29:44,640 INFO train.py line 211 4010323] iter: 150, total_loss: 0.08101960271596909, loss_1: 0.1053466796875, loss_2: 0.08416748046875, loss_3: 0.051544189453125
[2025-01-15 16:29:46,527 INFO train.py line 211 4010323] iter: 160, total_loss: 0.07677431404590607, loss_1: 0.08843994140625, loss_2: 0.07183837890625, loss_3: 0.05230712890625
[2025-01-15 16:29:48,415 INFO train.py line 211 4010323] iter: 170, total_loss: 0.10389444231987, loss_1: 0.1302490234375, loss_2: 0.101318359375, loss_3: 0.0667724609375
[2025-01-15 16:29:50,266 INFO train.py line 211 4010323] iter: 180, total_loss: 0.07230211794376373, loss_1: 0.09295654296875, loss_2: 0.06329345703125, loss_3: 0.04638671875
[2025-01-15 16:29:52,136 INFO train.py line 211 4010323] iter: 190, total_loss: 0.06736837327480316, loss_1: 0.0704345703125, loss_2: 0.06683349609375, loss_3: 0.047119140625
[2025-01-15 16:29:54,020 INFO train.py line 211 4010323] iter: 200, total_loss: 0.08309701830148697, loss_1: 0.10699462890625, loss_2: 0.0660400390625, loss_3: 0.056304931640625
[2025-01-15 16:29:55,899 INFO train.py line 211 4010323] iter: 210, total_loss: 0.09184688329696655, loss_1: 0.10711669921875, loss_2: 0.09912109375, loss_3: 0.0576171875
[2025-01-15 16:29:57,777 INFO train.py line 211 4010323] iter: 220, total_loss: 0.08720529079437256, loss_1: 0.10614013671875, loss_2: 0.095703125, loss_3: 0.05255126953125
[2025-01-15 16:29:59,691 INFO train.py line 211 4010323] iter: 230, total_loss: 0.13515378534793854, loss_1: 0.257568359375, loss_2: 0.191162109375, loss_3: 0.01358795166015625
[2025-01-15 16:30:01,549 INFO train.py line 211 4010323] iter: 240, total_loss: 0.08366531133651733, loss_1: 0.07135009765625, loss_2: 0.07098388671875, loss_3: 0.06317138671875
[2025-01-15 16:30:03,475 INFO train.py line 211 4010323] iter: 250, total_loss: 0.09925616532564163, loss_1: 0.183349609375, loss_2: 0.1461181640625, loss_3: 0.014190673828125
[2025-01-15 16:30:05,377 INFO train.py line 211 4010323] iter: 260, total_loss: 0.0611848458647728, loss_1: 0.07440185546875, loss_2: 0.06072998046875, loss_3: 0.037078857421875
[2025-01-15 16:30:07,255 INFO train.py line 211 4010323] iter: 270, total_loss: 0.07296711951494217, loss_1: 0.08929443359375, loss_2: 0.0679931640625, loss_3: 0.044769287109375
[2025-01-15 16:30:09,159 INFO train.py line 211 4010323] iter: 280, total_loss: 0.09899647533893585, loss_1: 0.1717529296875, loss_2: 0.10980224609375, loss_3: 0.01959228515625
[2025-01-15 16:30:11,036 INFO train.py line 211 4010323] iter: 290, total_loss: 0.070803202688694, loss_1: 0.05999755859375, loss_2: 0.05303955078125, loss_3: 0.057708740234375
[2025-01-15 16:30:12,884 INFO train.py line 211 4010323] iter: 300, total_loss: 0.0687723308801651, loss_1: 0.08404541015625, loss_2: 0.07757568359375, loss_3: 0.039703369140625
[2025-01-15 16:30:14,767 INFO train.py line 211 4010323] iter: 310, total_loss: 0.05694175511598587, loss_1: 0.0723876953125, loss_2: 0.047821044921875, loss_3: 0.0379638671875
[2025-01-15 16:30:16,613 INFO train.py line 211 4010323] iter: 320, total_loss: 0.12303216010332108, loss_1: 0.3173828125, loss_2: 0.0863037109375, loss_3: 0.0130767822265625
[2025-01-15 16:30:18,479 INFO train.py line 211 4010323] iter: 330, total_loss: 0.05874193459749222, loss_1: 0.070556640625, loss_2: 0.0474853515625, loss_3: 0.04095458984375
[2025-01-15 16:30:20,357 INFO train.py line 211 4010323] iter: 340, total_loss: 0.061264798045158386, loss_1: 0.070556640625, loss_2: 0.045623779296875, loss_3: 0.047210693359375
[2025-01-15 16:30:22,204 INFO train.py line 211 4010323] iter: 350, total_loss: 0.06905524432659149, loss_1: 0.08984375, loss_2: 0.06121826171875, loss_3: 0.048126220703125
[2025-01-15 16:30:24,076 INFO train.py line 211 4010323] iter: 360, total_loss: 0.05862930044531822, loss_1: 0.06390380859375, loss_2: 0.05682373046875, loss_3: 0.0394287109375
[2025-01-15 16:30:25,931 INFO train.py line 211 4010323] iter: 370, total_loss: 0.07845214754343033, loss_1: 0.09552001953125, loss_2: 0.043243408203125, loss_3: 0.0606689453125
[2025-01-15 16:30:27,777 INFO train.py line 211 4010323] iter: 380, total_loss: 0.06235295161604881, loss_1: 0.060028076171875, loss_2: 0.04840087890625, loss_3: 0.05108642578125
[2025-01-15 16:30:29,658 INFO train.py line 211 4010323] iter: 390, total_loss: 0.0600152425467968, loss_1: 0.1279296875, loss_2: 0.04876708984375, loss_3: 0.007411956787109375
[2025-01-15 16:30:31,520 INFO train.py line 211 4010323] iter: 400, total_loss: 0.05290626734495163, loss_1: 0.0726318359375, loss_2: 0.053375244140625, loss_3: 0.02783203125
[2025-01-15 16:30:33,370 INFO train.py line 211 4010323] iter: 410, total_loss: 0.062056586146354675, loss_1: 0.06787109375, loss_2: 0.06610107421875, loss_3: 0.043060302734375
[2025-01-15 16:30:35,206 INFO train.py line 211 4010323] iter: 420, total_loss: 0.08131039142608643, loss_1: 0.09698486328125, loss_2: 0.0494384765625, loss_3: 0.06158447265625
[2025-01-15 16:30:37,093 INFO train.py line 211 4010323] iter: 430, total_loss: 0.0659327283501625, loss_1: 0.06414794921875, loss_2: 0.04913330078125, loss_3: 0.05072021484375
[2025-01-15 16:30:38,979 INFO train.py line 211 4010323] iter: 440, total_loss: 0.07210070639848709, loss_1: 0.1688232421875, loss_2: 0.050506591796875, loss_3: 0.0149078369140625
[2025-01-15 16:30:40,802 INFO train.py line 211 4010323] iter: 450, total_loss: 0.05678945779800415, loss_1: 0.09344482421875, loss_2: 0.0433349609375, loss_3: 0.0291290283203125
[2025-01-15 16:30:42,704 INFO train.py line 211 4010323] iter: 460, total_loss: 0.07431019842624664, loss_1: 0.123291015625, loss_2: 0.0550537109375, loss_3: 0.03857421875
[2025-01-15 16:30:44,578 INFO train.py line 211 4010323] iter: 470, total_loss: 0.05750691890716553, loss_1: 0.0758056640625, loss_2: 0.051513671875, loss_3: 0.0343017578125
[2025-01-15 16:30:46,427 INFO train.py line 211 4010323] iter: 480, total_loss: 0.0684354305267334, loss_1: 0.0821533203125, loss_2: 0.073486328125, loss_3: 0.043060302734375
[2025-01-15 16:30:48,321 INFO train.py line 211 4010323] iter: 490, total_loss: 0.08425012975931168, loss_1: 0.2095947265625, loss_2: 0.049896240234375, loss_3: 0.0141754150390625
[2025-01-15 16:30:50,017 INFO train.py line 248 4010323] => Loading checkpoint & weight ...
[2025-01-15 16:30:50,017 INFO train.py line 257 4010323] No weight found at: None
[2025-01-15 16:30:50,461 INFO train.py line 326 4010323] scale_0.0 has 30 groups, mesh_voting: True
[2025-01-15 16:30:50,473 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:50,720 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:50,848 INFO train.py line 326 4010323] scale_0.2 has 29 groups, mesh_voting: True
[2025-01-15 16:30:50,854 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:51,103 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:51,229 INFO train.py line 326 4010323] scale_0.4 has 30 groups, mesh_voting: True
[2025-01-15 16:30:51,235 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:51,489 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:51,611 INFO train.py line 326 4010323] scale_0.6 has 30 groups, mesh_voting: True
[2025-01-15 16:30:51,616 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:51,865 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:51,991 INFO train.py line 326 4010323] scale_0.8 has 28 groups, mesh_voting: True
[2025-01-15 16:30:51,996 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:52,248 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:52,376 INFO train.py line 326 4010323] scale_1.0 has 27 groups, mesh_voting: True
[2025-01-15 16:30:52,382 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:52,634 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:52,765 INFO train.py line 326 4010323] scale_1.2 has 24 groups, mesh_voting: True
[2025-01-15 16:30:52,770 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:53,024 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:53,159 INFO train.py line 326 4010323] scale_1.4 has 21 groups, mesh_voting: True
[2025-01-15 16:30:53,164 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:53,417 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:53,551 INFO train.py line 326 4010323] scale_1.6 has 12 groups, mesh_voting: True
[2025-01-15 16:30:53,556 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:53,803 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:53,941 INFO train.py line 326 4010323] scale_1.8 has 10 groups, mesh_voting: True
[2025-01-15 16:30:53,946 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:54,198 INFO train.py line 369 4010323] Mesh has 36457 faces
[2025-01-15 16:30:54,350 INFO train.py line 326 4010323] scale_2.0 has 6 groups, mesh_voting: True
[2025-01-15 16:30:54,354 INFO train.py line 361 4010323] shape of mesh_group (36457,)
[2025-01-15 16:30:54,611 INFO train.py line 369 4010323] Mesh has 36457 faces
